
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adam Caudill</title>
  <meta name="author" content="Adam Caudill">

  
  <meta name="description" content="While facing an interesting research challenge, digging into the inner working of Windows, I realized that I needed to change a registry value. That &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://adamcaudill.com//page/37">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Caudill" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-106942-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Caudill</a></h1>
  
    <h2>Independent Security Researcher &amp; Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamcaudill.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/speaking/">Speaking</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2006/09/17/running-regedit-as-system/">Running RegEdit as SYSTEM</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-09-17T19:59:49-04:00" pubdate data-updated="true">Sep 17<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While facing an interesting research challenge, digging into the inner working of Windows, I realized that I needed to change a registry value. That&#8217;s simple enough, I fire up RegEdit, make the change, then politely as RegEdit knows how, it told me that I <em>couldn&#8217;t change the value</em>! Being one that hates when <em>my</em> computer tells <em>me</em> I can&#8217;t do something, I had to find another option.</p>

<p>So after some research, I found my answer: <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/sc.mspx?mfr=true">sc</a>. This is a great little utility (included with Windows), and made the task of running an application as SYSTEM*  much easier. At this point some of you may be wondering why I didn&#8217;t just use <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/runas.mspx?mfr=true">RunAs</a> instead, as it&#8217;s designed to allow execution as another user. Well, from all that I&#8217;ve found, there is no way to get RunAs to spawn a process as SYSTEM, one of the downsides of SYSTEM not being a true user.</p>

<p>Another option that I found (somewhat) attractive initially is <a href="http://www.codeproject.com/system/RunUser.asp">RunAsEx</a>, an open source, GUI based version of RunAs. This could be useful, but I found it to be more hassle than it was worth. Still might be useful for somethings, but with all the bugs I found in it, I knew there was a better way.</p>

<p>Now, back to the solution I chose: Using sc to create a service that will execute the application I&#8217;m after. This works because by default all services execute under the SYSTEM user context, so all we have to do is create a service to call the application we need. Surprisingly simple, and it works quite well.</p>

<p>Creating the service looks something like this:</p>

<p><code>SC CREATE AcDebugSvc binPath= "regedit.exe" type= own type= interact</code> <em>**</em></p>

<p>This creates the service, so that now all you have to do is start the service (<code>SC START AcDebugSvc</code> ***) and you&#8217;ll see your copy of RegEdit. If you check in Task Manager, you&#8217;ll be able to confirm that it is actually running as SYSTEM. This is an extremely powerful debugging tool, as it allows you to instantly execute any application as the most powerful user that Windows offers.</p>

<p>Once you are done with your work, just delete the service (<code>SC DELETE AcDebugSvc</code>) and call it a day, that simple. This can also easily be scripted if you tire of typing the commands so often, and it can also be used with most applications. Using this for the Command Prompt (<code>binPath= "cmd.exe /K start"</code>) and for Task Manager (<code>binPath= "taskmgr.exe"</code>) both strike me as being quite useful.</p>

<ul>
<li><strong>WARNING</strong>: As I hope most of you know, System is a very powerful account, it&#8217;s almost limitless in what it can do. If you aren&#8217;t careful while working under this user context; you may end up with a rather expensive paperweight instead of a computer. You have been warned.</li>
</ul>


<p>** Note: As odd as it is, the spaces after the equals and before the value of the parameters is quite important, the call will fail if you omit them.</p>

<p>*** Note: You&#8217;ll get an error message (&#8221;<code>The service did not respond to the start or control request in a timely fashion.</code>&#8221;) when you call this, it&#8217;s nothing to worry about. The reason that it occurs is that to respond to the message it receives the target application must be designed to operate as a service. Since we are using this for other purposes we, we don&#8217;t really care.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2006/09/17/firefox-toys-errorzilla/">FireFox Toys: ErrorZilla</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-09-17T12:49:44-04:00" pubdate data-updated="true">Sep 17<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While my favorite browser will always be <a href="http://www.opera.com/">Opera</a>, I&#8217;m a big fan of <a href="http://www.mozilla.com/firefox/">Firefox</a>; its amazing selection of add-ons (a feature that Opera sadly lacks) adds much to its value for me. With the addition of plug-ins like the excellent <a href="http://chrispederick.com/work/webdeveloper/">Web Developer</a> add-on, Firefox becomes a powerful development and browsing platform.</p>

<p><a href="http://adamcaudill.com/files/2006/09/sc37757375032.png"><img src="http://adamcaudill.com/files/2006/09/sc37757375032.thumbnail.png" alt="ErrorZilla" /></a> I just learned of a new add-on released by Eric of <a href="http://roachfiend.com/">roachfiend.com</a> called <a href="http://roachfiend.com/archives/2006/08/28/errorzilla-useful-error-pages-for-firefox/">ErrorZilla</a>, this is a great idea. It&#8217;s a replacement for the default Firefox error pages, new error pages with additional features. Here&#8217;s the quick run-down of the new options presented:</p>

<ul>
<li><p>Try again (refresh)</p></li>
<li><p>Google Cache</p></li>
<li><p>Wayback</p></li>
<li><p>Ping</p></li>
<li><p>Trace</p></li>
<li><p>Whois</p></li>
</ul>


<p>Now, when faced with a dreaded &#8220;Server not found&#8221; error, it&#8217;s much easier to find <em>some</em> useful information. When researching a topic, there&#8217;s nothing worse than having to go in circles trying to find a page that will load, this add-on is certainly a step in the right direction. I really hope that the Firefox developers see this add-on and consider adding this or similar functionality to the distribution.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2006/09/16/kill-capslock/">Kill CapsLock!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-09-16T13:42:02-04:00" pubdate data-updated="true">Sep 16<span>th</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Most people I know have issues with the CapsLock key; with feelings ranging from annoyance to sheer hatred. More often than not, I fall into the sheer hatred side of things. I&#8217;ve played with various ideas to solve the problem. Everything from a system tray notification when CapsLock is on, to physically removing the evil key itself. After all these attempts, I have found I like none of them.</p>

<p>Enter <a href="http://winadmin.forret.com/registry/wanocaps/">waNOCAPS</a> (from the <a href="http://winadmin.forret.com/">Winadmin tools</a> project), a registry modification to quickly and cleanly remap the CapsLock to a third Ctrl key. This is nice in that it&#8217;s a simple registry change, not something as ugly as a background program to alter the CapsLock state or value as many CapsLock killers use.</p>

<p>This seems to be a clean, simple solution to an annoying &#8220;feature&#8221; - one I&#8217;ll certainly be using.</p>

<p><strong><em>Update</em></strong>: It looks like the original page has been removed, but you can still access the files <a href="http://sourceforge.net/project/showfiles.php?group_id=88417">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2006/09/03/detailed-css-changes-in-ie7/">Detailed CSS Changes in IE7</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-09-03T20:55:35-04:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As <a href="http://www.microsoft.com/windows/ie/ie7/about/default.mspx">IE7</a> approaches release, the <a href="http://blogs.msdn.com/ie/default.aspx">IE team</a> has released a detailed list of the <a href="http://blogs.msdn.com/ie/archive/2006/08/22/712830.aspx">200+ CSS changes</a> that will appear in the final release. If you do any web development, this is a great time to read the list and audit the CSS that your sites use. IE7 breaks many of the old hacks used to work around the bugs in previous versions, so careful attention will be needed to ensure everything keeps working and looking as intended.</p>

<p>IE7 is a major step forward, and all web developers owe the IE team a &#8216;thanks&#8217; for being so transparent in this process and making detailed change lists such as this one available.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2006/09/03/xml-notepad-2006/">XML Notepad 2006</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-09-03T14:26:19-04:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2006</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://adamcaudill.com/files/2006/09/sc22708156232.png"><img src="http://adamcaudill.com/files/2006/09/sc22708156232b.png" alt="XMLNotepad 2006" /></a> Microsoft&#8217;s Chris Lovett (of System.Xml fame) has released <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=72d6aa49-787d-4118-ba5f-4f30fe913628&amp;DisplayLang=en">XML Notepad 2006</a> - a simple, easy to use, and free, XML editor. For those that regularly work with XML, an editor of this type can be an invaluable addition to your toolbox.</p>

<p>XML Notepad offers a basic set of features, great for those quick jobs where using an IDE or a more full-featured application would be overkill. While XML Notepad doesn&#8217;t offer a great range of features, it does offer some of the most important features needed to get the job done.</p>

<p>As a real bonus, XML Notepad was released complete with its design documentation and source code. Always nice to take a peak under the hood of the projects Microsoft releases.</p>

<p>The only major gripe I have with this tool is the lack of a syntax-highlighted viewer for the XML source. In fact, it uses its non-XML cousin, Notepad to view the underlying XML. Thankfully, as this project was released with source, it should be easy to add a few new features such as this.</p>

<p>For those interested, here&#8217;s the feature overview:</p>

<ul>
<li><p>Tree View synchronized with Node Text View for quick editing of node names and values.</p></li>
<li><p>Incremental search (Ctrl+I) in both tree and text views, so as you type it navigates to matching nodes.</p></li>
<li><p>Cut/copy/paste with full namespace support.</p></li>
<li><p>Drag/drop support for easy manipulation of the tree, even across different instances of XML Notepad and from the file system.</p></li>
<li><p>Infinite undo/redo for all edit operations.</p></li>
<li><p>In place popup multi-line editing of large text node values.</p></li>
<li><p>Configurable fonts and colors via the options dialog.</p></li>
<li><p>Full find/replace dialog with support for regex and XPath.</p></li>
<li><p>Good performance on large XML documents, loading a 3mb document in about one second.</p></li>
<li><p>Instant XML schema validation while you edit with errors and warnings shown in the task list window.</p></li>
<li><p>Intellisense based on expected elements and attributes and enumerated simple type values.</p></li>
<li><p>Support for custom editors for date, dateTime and time datatypes and other types like color.</p></li>
<li><p>Handy nudge tool bar buttons for quick movement of nodes up and down the tree.</p></li>
<li><p>Inplace HTML viewer for processing xml-stylesheet processing instructions.</p></li>
<li><p>Built-in XML Diff tool.</p></li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/38/">&larr; Older</a>
    
    <a href="/archives/">Blog Archives</a>
    
    <a class="next" href="/page/36/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=250" class="aligncenter"></p>
  <p>I am an independant security researcher and software developer with more than 15 years of experience. I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p>
  <p>Email: <a href="mailto:adam@adamcaudill.com">adam@adamcaudill.com</a> (<a href="https://adamcaudill.com/pgp/">PGP</a>)</p>
</section>
<section>
  <h1>Links</h1>
	<ul>
		<li><a href="https://twitter.com/adamcaudill">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/adamcaudill">LinkedIn</a></li>
		<li><a href="https://github.com/adamcaudill">GitHub</a></li>
		<li><a href="http://www.flickr.com/people/adamcaudill/">Flickr</a></li>
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/11/19/responsible-disclosure-is-wrong/">Responsible Disclosure Is Wrong</a>
      </li>
    
      <li class="post">
        <a href="/2015/05/18/making-bsides-knoxville/">Making BSides Knoxville</a>
      </li>
    
      <li class="post">
        <a href="/2015/04/13/crypto-front-door-everyone-welcome/">Crypto Front Door: Everyone Welcome!</a>
      </li>
    
      <li class="post">
        <a href="/2015/03/08/on-the-underhanded-crypto-contest/">On the Underhanded Crypto Contest</a>
      </li>
    
      <li class="post">
        <a href="/2015/02/17/the-evolution-of-paranoia/">The Evolution of Paranoia</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adamcaudill">@adamcaudill</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adamcaudill',
            count: 4,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Enjoy this site? Consider donating via Bitcoin to <strong>14jumFDmuVkLiAt4TgyKt17SWHtPRbkcLr</strong>.<br>
  Copyright &copy; 2015 - Adam Caudill -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
