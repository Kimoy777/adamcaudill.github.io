
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adam Caudill</title>
  <meta name="author" content="Adam Caudill">

  
  <meta name="description" content="Last week I gave a lighting talk at the DEFCON CryptoVillage on SMIMP. The talk went over the basics of why the project is needed, and how the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://adamcaudill.com//page/3">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Caudill" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-106942-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Caudill</a></h1>
  
    <h2>Independent Security Researcher &amp; Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamcaudill.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/16/smimp-at-the-defcon-cryptovillage/">SMIMP at the DEFCON Crypto Village</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-16T00:00:00-04:00" pubdate data-updated="true">Aug 16<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last week I gave a lighting talk at the DEFCON CryptoVillage on <a href="http://smimp.org/">SMIMP</a>. The talk went over the basics of why the project is needed, and how the specification works.</p>

<p>Here are the slides:</p>

<iframe src="//www.slideshare.net/slideshow/embed_code/38040741?rel=0&startSlide=2" width="512" height="421" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>


<p>Here is a rough transcript of the talk:</p>

<p><em>Slide 1:</em> I&#8217;m Adam Caudill, Iâ€™m a developer and security researcher; I work on a number of different things, but my recent work has been around privacy and secure messaging.</p>

<p>We all know that email security is a real problem, and thanks to a certain whistleblower we know those weaknesses are actively being exploited on a massive scale. I&#8217;m here to talk about some of the issues, and a project I&#8217;ve been working on called SMIMP. It&#8217;s a secure messaging protocol that aims to address the use cases of email, and to be a viable option to replace email as we know it.</p>

<p><em>Slide 2:</em> This image illustrates the issues with email better than anything I&#8217;ve seen.</p>

<p>It&#8217;s decades old, wasn&#8217;t designed for the threats that exist today, and as a result - this is what we&#8217;ve done to it. We&#8217;ve glued on various bits to make it look and feel like something it isn&#8217;t. STARTTLS helps protect from passive monitoring, but that&#8217;s only one attack vector out of so many - and even then, it&#8217;s often opportunistic, so it fails open and is subject to Man In The Middle attacks.</p>

<p>GPG helps protect message content, but it&#8217;s hard for the average user to understand and doesn&#8217;t do anything for metadata.</p>

<p>No matter what we try to glue on to email, it&#8217;s still a protocol that fails on many fronts.</p>

<p><em>Slide 3:</em> Not only is email as it exists today not designed to provide any protection from state-level attackers, it doesn&#8217;t even provide any protection from a rogue sysadmin. Thanks to the various bits that have been glued on over the years, it&#8217;s a bit better when circumstances are ideal - but it still fails on so many fronts.</p>

<p>For a messaging protocol to have any chance of being secure, privacy and security need to be evaluated and included in every design decision, from the very first day - attempting to glue them on after the fact leads to the kind of failure we&#8217;ve seen with email.</p>

<p>I know I&#8217;m preaching to the choir here. We all know it&#8217;s a mess, we all know it&#8217;s a problem that needs to be addressed.</p>

<p><em>Slide 4:</em> There are many people looking to make the situation better, and on many fronts, and these efforts  do help a little bit at a time - but often only for people that know how to leverage the tools, or can get others to implement solutions. For the vast majority of users, the current state of email security is pretty dismal.</p>

<p>The question is, does it make sense, in the long term, to keep trying to find ways to improve email with security focused clients (such as Mailpile), better self-hosting setups, fighting companies to implement STARTTLS, and so on. Or, should we be pushing for a new protocol that&#8217;s built for security and privacy from the ground up? Avoiding the mistakes of the past, shedding the dead weight of obsolete protocols and techniques.</p>

<p>There are huge compatibility and interoperability issues that have to be addressed for any protocol to be successful of course - when you are trying to replace a system used by billions, dealing with legacy systems is something of a big deal.</p>

<p>The fact is, it <em>needs</em> to be replaced with something better, but even calling such an effort a massive undertaking is an understatement. But, if it is to be replaced, it needs to start with groups like this, so that what&#8217;s built will live up to the demands that will be placed on it.</p>

<p><em>Slide 5:</em> Towards the goal of finding a better option for email, I began writing a specification. If I&#8217;m going to complain about a problem I should offer a solution, right?</p>

<p>SMIMP is a general purpose messaging system designed with a few key goals in mind:</p>

<ul>
<li>Minimal metadata</li>
<li>Encrypt as much as possible</li>
<li>Covers existing email use cases</li>
<li>Simple to use; normal users need to be able to use it</li>
<li>Useable in corporate environments that have special handling requirements - such as HIPAA, SarbOx, etc. - This is a big advantage against options like bitmessage; there has to be a balance between security, and meeting the varying demands of the different environments this could be used in.</li>
</ul>


<p>Another goal is ease of implementation - on both the client and server ends; so it&#8217;s a REST-like web service, and the data is passed as JSON. This way developers can leverage well-tested code instead of writing everything from scratch. This also means that it&#8217;s easy for people to host their own server with a minimal time / effort investment.</p>

<p><em>Slide 6:</em> SMIMP is made up of two major components, identity management and messaging. I believe it&#8217;s critical that these are combined into a single protocol to allow for key pain points in traditional email to be addressed - the largest being public key discovery. For GPG, this can be a real challenge for users, especially when trying to find the key for certain high-profile people; has anyone looked for Jacob Applebaum&#8217;s key? It&#8217;s Bad.</p>

<p>Every user has one public signing key in their profile information - the key is tied to the user&#8217;s address, so to find a user&#8217;s key, all you need is their address. This provides a clean, simple way to identify the appropriate key for a user. Of course, ideally users should verify public signing keys via a trusted channel such as a phone call.</p>

<p>To protect the integrity of the profile information, all changes are signed with the user&#8217;s signing key, and includes the hash of the prior change - creating a hash chain from the first, to the most recent change, allowing for simple validation that the records haven&#8217;t been altered.</p>

<p>To protect against a malicious server, there are a couple checks that clients can perform:</p>

<ul>
<li>Pin the most recent signing key, if it disappears from the user&#8217;s profile, then the information is being truncated, possibly to force the use of a compromised key.</li>
<li>Pin the original signing key from when the account was created; if that ever changes, that is a clear indication that the entire history for a user has been replaced.</li>
</ul>


<p>On the messaging side, all messages and most metadata is encrypted; the only data exposed is the data needed for the server to function. There are multiple message types, so not only does it support email like messages, it supports custom, application specific messages; this allows other message-centric applications to use SMIMP as a transport, making it easier to build secure messaging applications.</p>

<p>There are a few anti-spam protections in place - seeing as the server won&#8217;t be able to scan content anymore.</p>

<ul>
<li>Dynamic hashcash-like proof of work</li>
<li>Blacklists to reject everything from an address or domain</li>
<li>Whitelists to allow addresses or domains to bypass the proof of work check.</li>
</ul>


<p>The envelope is JSON, for email, the message is JSON, the formats are extensible, making it easy to add new functionality.</p>

<p>Everything is designed around a simple set of principles:</p>

<ul>
<li>Secure</li>
<li>Private</li>
<li>Easy to implement</li>
<li>Hard to screw-up</li>
</ul>


<p><em>Slide 7:</em> So, what&#8217;s the status today&#8230;</p>

<p>The specification is still a work in progress and is available from smimp.org, along with more background of what it is, and why it&#8217;s designed the way it is.</p>

<p>I wouldn&#8217;t try building against it just yet, it&#8217;s still too immature, but if anybody wants to put their 2 cents in, the specification is on github and pull requests are welcome. The goal here is to get feedback, address issues, and try to build a community driven specification - my goal isn&#8217;t to write a specification myself and then push it on the world assuming it&#8217;s perfect.</p>

<p>I&#8217;ve invested a fair bit of time into SMIMP, but it&#8217;s certainly not perfect, and the final solution to the email problem may not be anything like SMIMP - and I&#8217;m fine with that.</p>

<p>What&#8217;s needed is more people looking not at how to we glue more things on email, but looking at how could we replace it. We need to get more people talking about possible solutions, for more people to contribute to specifications, or write new ones, to get more people focused on the one goal that will actually fix email security - replacing it.</p>

<p><em>Slide 8:</em> I encourage you to look at the specification, to think about how replacing email could be achieved, and find people to work with to achieve this.</p>

<p>If you have any questions, suggestions, or complaints - I&#8217;ll be in the area for a bit.</p>

<p>Thanks!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/07/26/on-strong-identity-management/">On Strong Identity Management</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-26T22:16:00-04:00" pubdate data-updated="true">Jul 26<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Alice wants to send an encrypted message to Bob; she knows his address, but doesn&#8217;t know the public key that goes with that address. Using GPG, Alice would look up his address on a key server, the issue is of course that anyone can upload a key associated with Bob&#8217;s address.</p>

<p>Using the &#8220;web of trust&#8221; model, Alice would look at the different keys and see which ones are signed, and if any of them are signed by people she knows. The problem is that Alice doesn&#8217;t normally use GPG, and she hasn&#8217;t marked the keys of the people she knows as trusted (I expect this is true for most casual GPG users), thus, she can&#8217;t tell what key is signed by keys she should trust, versus the ones signed by keys she shouldn&#8217;t.</p>

<p>In years of effort, this is still an issue.</p>

<p>There are many issues with this model, especially when it comes to casual users that don&#8217;t understand the details of the &#8220;web of trust&#8221; - while GPG use is certainly going up thanks largely to the Snowden revelations, many of these users fit into the casual users group. Thanks to the complexities of the model, these users may not be getting the level of protection they think they are.</p>

<p>Here are just a few of these issues:</p>

<ul>
<li>Lack of strong linking - there isn&#8217;t a strong, verifiable connection between a user&#8217;s address, and their public key.</li>
<li>Complex user interaction - to be useful, the user has to understand the web of trust model, and how to leverage it. Based on the discussions I&#8217;ve had with people that recently started using it, most don&#8217;t get it.</li>
<li>Key discovery - finding the right key can be a nightmare, especially for some people. When there are multiple &#8220;valid&#8221; keys published, each with signatures, it can be hard for novice users to figure out which one is right.</li>
</ul>


<p>I could go on, but I think the point is clear - the web of trust works well for some users, but only the users that take the time to really understand it.</p>

<p><strong>The <em>IM</em> in SMIMP</strong></p>

<p>I&#8217;ve been drafting a <a href="https://github.com/smimp/smimp_spec">specification</a> for a secure messaging protocol called <a href="http://smimp.org/">SMIMP</a>, as far as I&#8217;m concerned the Identity Management component is the most important part. It&#8217;s what allows the rest to work - secure messaging isn&#8217;t that hard, key handling and validation is where end user system start to fail.</p>

<p>To provide a strong identity management system, a few goals need to be met:</p>

<ul>
<li>Strong link between address and public key.</li>
<li>Updates to identity information signed by the user to prevent unauthorized changes.</li>
<li>Provide a full history, including all changes from the time the account was created.</li>
<li>Use of a hash-chain to show that no changes have been removed.</li>
</ul>


<p>The IM in SMIMP meets all of these. The suggested way of using the system is trust on first use, pinning on both the first and the most recent public key. It would also be wise for the user to validate the recipient&#8217;s current public key via a trusted channel on first use, but that&#8217;s something that rarely happens in practice.</p>

<p>To detect a malicious server, or modified traffic, the user&#8217;s client should first check to see if the original public key has changed - if it has, it indicates that the user&#8217;s information has been replaced in its entirety. Second, it should see if the most recent key is no longer listed in the user&#8217;s history - if its been removed, it indicates that the user&#8217;s history has been truncated, possibly in an attempt to encourage the use of a compromised key. These checks provide an easy way for client software to validate that keys can be trusted.</p>

<p>To make the system more useful, the SMIMP identity information includes more than just the public key (all of which are optional):</p>

<ul>
<li>Name</li>
<li>Web site</li>
<li>List of social media profiles</li>
<li>Additional data (comments, or other data the user wishes to assert)</li>
</ul>


<p>This provides a simple way to strongly tie addresses to public keys; thus making secure messaging easier and more understandable for casual / non-technical users. For a solution to be widely useable, it needs to be effective for everyone.</p>

<p><strong>The best solution?</strong></p>

<p>SMIMP may not be the best solution, and there are some things about it that I don&#8217;t care for myself - such as exposure of more metadata than I&#8217;d like. But, it is a solution to the issues surrounding email, and identity management.</p>

<p>The <a href="https://adamcaudill.com/2014/06/27/the-sinking-ship-of-email-security/">issues</a> of email security can be fixed, and identity management is part of that problem. There has to be a way to tie a user to their public key in a more reliable manor than what we have today (and without resorting to the mandatory government ID idea that won&#8217;t die).</p>

<p>I encourage everyone to look at these issues, and think about possible solutions. Contribute to SMIMP or one of the other efforts to fix the issues around email; we can no longer ignore these issues. The community needs to find and implement solutions that assure the security and privacy of the global community.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/07/23/jumping-through-hoops-dot-dot-dot/">Jumping Through Hoops&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-23T18:11:00-04:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are two ways to implement security:</p>

<ul>
<li>Real security, based on empirical evidense and analysis.</li>
<li>Checklist security, based on the latest checklist somebody says is important.</li>
</ul>


<p>When security is based on real evidence and analysis, policies are enacted based on real gain and measured against the business impact. Risks are considered, and the costs versus benefits are well understood so that policy choices are based on real, useful information.</p>

<p>On the other hand there&#8217;s security by checklist. Costs aren&#8217;t calculated, risks aren&#8217;t understood, business impacts are ignored. All that matters is that somebody gets to check a box on a form; there&#8217;s no understanding, no logic, and likely no real benefits involved.</p>

<p>The point of security policies isn&#8217;t to show off how many hoops you&#8217;ve built that people have to jump through when doing their jobs. Yet, when a company accepts a security by checklist mentality, this is exactly what they are doing. They spend their time building hoops that they can show off later while ignoring the threats they are supposed to be addressing.</p>

<p>Recently, my laptop died, the new laptop was setup with DLP, or digital loss prevention software. The main purpose of the software is to prevent me and anyone in my group from being able to use removable drives - so that we can&#8217;t load them up with private information of course.</p>

<p>This was done to check a box on a form, at no point did anyone actually think about the bigger picture, what the threat was, and how it should be addressed:</p>

<ul>
<li>I have a laptop and work remotely.</li>
<li>When I disconnect from the VPN, I have unrestricted access to the internet.</li>
<li>I routinely work with sensitive data, so it&#8217;s not uncommon for it to be on my computer.</li>
<li>I could easily encrypt a file full of private data, and upload it to the cloud after disconnecting from the VPN, and nobody would know.</li>
</ul>


<p>So, by blocking the use of removable drives, they made it much harder for me to recover from a failing laptop, and added nothing to security. Blocking thumb drives won&#8217;t stop a person from stealing data when they have other ways they could do the same thing. All it did was waste time and the company&#8217;s money.</p>

<p>They built a new hoop to show off, nothing more.</p>

<p>Such policies don&#8217;t help anyone - they don&#8217;t improve security, they certainly don&#8217;t prevent theft of data, and at the same time, they do have a negative business impact. Lost productivity, increased frustration, and in the end higher turn-over from employees that are fed up from the meaningless work. There&#8217;s no winner here - except the person that wants to show off all of the hoops they have.</p>

<p>Security based on anything other than empirical evidence and legitimate analysis is just theater and nothing more.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/06/27/the-sinking-ship-of-email-security/">The Sinking Ship of E-Mail Security</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-27T23:32:00-04:00" pubdate data-updated="true">Jun 27<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>E-Mail, the venerable old standard for internet text messages, dating back to the early 1980s - and back to the early 1970s in other forms, has long been the &#8220;killer app&#8221; of the internet. While so many companies try to make the next great thing that&#8217;ll capture users around the world - none of these compare to the success of e-mail. It is likely the single most entrenched application-layer protocol used today.</p>

<p>Thanks to <a href="https://en.wikipedia.org/wiki/Stellar_Wind">STELLARWIND</a> and other NSA programs, we have also seen that it has failed in a very real, and very important way.</p>

<p>But this isn&#8217;t exactly news is it?</p>

<p>The security issues around e-mail - or rather the complete lack of security in the protocol has been well understood for decades. Yet, in all those years of existence, all we, as those that care about security have managed to do is glue ineffective solutions on it.</p>

<p><strong>STARTTLS</strong></p>

<p>In the last year, since the scope of NSA&#8217;s spying has been made clear to the world - and the reminder that the NSA isn&#8217;t the only player in this game, the use of STARTTLS has <a href="https://www.google.com/transparencyreport/saferemail/?hl=en">spread dramatically</a>. Many people have worked hard to make this happen - and it really has made things better. Kinda.</p>

<p>While STARTTLS does enable TLS, thus encrypting the data over the wire, it&#8217;s far from perfect:</p>

<ul>
<li>Opportunistic - In the majority of occasions the encryption is opportunistic; meaning that certificates aren&#8217;t validated, and if something goes wrong in the TLS negotiation, the connection will fail-open - passing data in the clear.</li>
<li>Server Trust - E-mail as it exists today places complete trust in not only the sending server, but also the recipients server - and every other relaying server. Any of these can log all correspondence, as the data is only encrypted during the transport. TLS can be added or dropped at any point in the chain, and this exposes multiple possible intercept points.</li>
</ul>


<p>Based on the famous &#8220;SSL added and removed here&#8221; NSA slide, we see that even if the messages are sent over an encrypted connection, that doesn&#8217;t mean they stay encrypted when moved around within a company. There are so many failure points that can lead to an attacker being able to collect data.</p>

<p>So if groups like the NSA want e-mail, it takes some extra effort thanks to STARTTLS, but it doesn&#8217;t solve the problem.</p>

<p><strong>PGP / GPG</strong></p>

<p>PGP, and the compatible (and likely more commonly used) GPG are one of the best options people have to encrypt their email - but there&#8217;s still a great deal of data exposed.</p>

<ul>
<li>UX - The user experience for most applications goes beyond unfriendly, to the point of being actively hostile. I recently walked an experienced developer through setting up a key with Gpg4win - the process of getting everything setup and working was beyond painful. The only GPG wrapper that I&#8217;ve seen that isn&#8217;t unreasonably difficult is GPGTools for OSX.</li>
<li>Web of Trust - The web of trust model that PGP uses is both genius and terrible. When a news organization started using PGP, I noticed that none of their keys were signed by anyone - so I tried explaining the concept to one of their journalists. After several tweets we moved the conversation to e-mail, which led to several multi-page emails. By the end, I think he was more confused than ever. Last I checked, their keys still aren&#8217;t signed.</li>
<li>Metadata - <a href="http://abcnews.go.com/blogs/headlines/2014/05/ex-nsa-chief-we-kill-people-based-on-metadata/">Metadata kills</a>. It&#8217;s scary but true - people die based on who they talk to. How long till an investigative journalist reporting on an organization not friendly to the US gets droned for emailing the wrong people? PGP doesn&#8217;t hide who is emailed, the subject, or any of the headers. PGP encrypted email leaks useful information like a sieve.</li>
<li>Client Integration - Not many email clients natively support PGP, so most users have to encrypt manually, or use a third-party add-on. This can lead to interesting information leaks, such as saving unencrypted drafts to the server.</li>
<li>Mobile - Using PGP on a mobile device can be risky, as it requires storing the private key on devices that are likely to have known security issues. Many people recommend against it, as it puts the private key at too much risk.</li>
</ul>


<p>So while PGP / GPG protects the content of email, it still is subject to metadata collection.</p>

<p><strong>S/MIME</strong></p>

<p>For those that don&#8217;t like PGP, or want a better chance of having native support, there&#8217;s S/MIME. Like PGP, S/MIME has it&#8217;s share of issues which leave users with less protection than they realize.</p>

<ul>
<li>Certificates - To use S/MIME, you have to have a certificate issued from a CA. The question is, how trustworthy is it? CAs have been hacked to issue bad certificates in the past, and nobody knows what an NSL could be used for when issued to a CA.</li>
<li>Key Escrow - Some CAs generate the private key on their side to allow them to provide a key escrow service. While this can be useful if you ever lose your key and want to read your email again, it also runs the risk of an unauthorized party getting access to the key.</li>
<li>Metadata - The metadata issues noted for PGP applies here as well. The subject, the recipients, the headers are all in clear text.</li>
</ul>


<p>There are other various complaints around S/MIME that are well documented, and have been discussed countless times. The point is, it&#8217;s another partial solution just glued onto email in an attempt to make it do something it was never designed to do. Be secure.</p>

<p><strong>The list goes on&#8230;</strong></p>

<p>Much work has went into other various add-ons, such as SPF and DKIM and others that attempt to do things that could have been done by default if e-mail had been designed with authentication, privacy, and security in mind.</p>

<p>When e-mail was designed, none of these issues were considered - people have been trying to find ways to fix that mistake for years. E-mail was open, plain text, security and privacy weren&#8217;t considered - or at least not to the extent required.</p>

<p>For a system like e-mail to be secure, security has to be part of the core design, considered at every step. When security &amp; privacy are an afterthought, something to just glue on - it&#8217;s impossible to achieve either.</p>

<p>There are many efforts underway now to improve the situation, some such as <a href="https://www.mailpile.is/">Mailpile</a>, I greatly respect. Their goals are noble, their purpose is true - but I also think they are fighting the wrong battle. E-mail as we know it is flawed beyond repair - we can make it leak less, but for all the work trying to overcome the design flaws, it&#8217;ll always be flawed. There&#8217;s only one way for e-mail to ever be secure.</p>

<p><strong>Time for action!</strong></p>

<p>Over the past few months I&#8217;ve been working on a specification for a system to replace e-mail. I don&#8217;t know if it&#8217;ll ever go anywhere - but that&#8217;s not the point. E-mail as we know it needs to be replaced - it can&#8217;t be fixed. We need to be discussing how to eliminate email, not new ways to glue partial solutions on to it. STARTTLS isn&#8217;t the answer, PGP isn&#8217;t the answer, S/MIME isn&#8217;t the answer - an entirely new protocol is.</p>

<p>I&#8217;m hoping to make the first public draft available in the next few weeks. If it&#8217;s well received, I&#8217;ll try to do what I can to get the system built. If not, then hopefully others will write competing specifications, and I&#8217;ll aide them as I can.</p>

<p>My goal for the specification I&#8217;m writing is to encourage discussion - to get people talking about how to solve the problem. If it contributes in any way to a new system, a system that&#8217;s designed from the beginning to be secure, then it&#8217;s worth every minute that&#8217;s been invested in it. We need to find a viable option that can replace the monstrosity that we have today.</p>

<p>I encourage everyone to think about solutions to this - how can we build a viable replacement to e-mail that meets the privacy and security goals, while being user friendly, and meeting the requirements of business and government environments. It&#8217;s a hard problem to solve, but it can be solved. It&#8217;s up to us to do it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/04/19/phpmyid-fixing-abandoned-oss-software/">phpMyID: Fixing Abandoned OSS Software</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-19T12:43:00-04:00" pubdate data-updated="true">Apr 19<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://siege.org/phpmyid">phpMyID</a> is a simple solution for those that want to run their own OpenID endpoint - the problem is that its author stopped maintaining the project in 2008. Despite this, there&#8217;s still quite a few people that use it, because it&#8217;s the easiest single-user OpenID option available.</p>

<p>Unfortunately, the author didn&#8217;t follow best practices when building the software, and as a result multiple security flaws were introduced. In 2008, a XSS was identified and never fixed (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2008-4730">CVE-2008-4730</a>), in the years since then it seems the software has been below the radar. While conducting a pentest I discovered a previously undocumented XSS (CVE-2014-2890) - which left me with a dilemma - what to do about it?</p>

<p>Looking at the code, I found a couple more potential XSS vulnerabilities - so the application clearly needed help, and if the author won&#8217;t do it, somebody should. Ethically, it seemed wrong to disclose the issue but leave users to fend for themselves; full disclosure is normally used to push a vendor into acting - but in this case it&#8217;s assured that there won&#8217;t be a vendor response.</p>

<p><strong>Fixing The Code</strong></p>

<p>One good thing is if a OSS project is abandoned, anyone can prepare patches to fix the issues. So, <a href="https://github.com/adamcaudill/phpMyID">that&#8217;s what I did</a>. I&#8217;ve committed fixes for both CVE-2008-4730 and CVE-2014-2890, as well as a couple potential issues. In both cases, the fix was easy:</p>

<p>CVE-2008-4730:</p>

<pre><code>@@ -439,7 +439,7 @@ function checkid ( $wait ) {
    if ($trust_root != $return_to) {
        // the urls are not the same, be sure return decends from trust
        if (! url_descends($return_to, $trust_root))
 -          error_500('Invalid trust_root: "' . $trust_root . '"');
 +          error_500('Invalid trust_root: "' . htmlentities($trust_root, ENT_QUOTES) . '"');

    }
</code></pre>

<p>CVE-2014-2890:</p>

<pre><code>@@ -568,7 +568,7 @@ function checkid_setup_mode () {
   */
  function error_mode () {
    isset($_REQUEST['openid_error']) 
 -      ? wrap_html($_REQUEST['openid_error'])
 +      ? wrap_html(htmlentities($_REQUEST['openid_error'], ENT_QUOTES))
        : error_500();
  }
</code></pre>

<p>I&#8217;ve only given the code a quick once-over, so there may be other issues - if I find time for a more thorough review I may commit additional fixes.</p>

<p><strong>Status of phpMyID</strong></p>

<p>I&#8217;m not taking over the maintenance of the project, I simply don&#8217;t have time to do the cleanup needed to bring it up to reasonable standards. I&#8217;d love to see somebody with a little time to invest cleanup the code and add more defensive measures. It needs some help, that&#8217;s clear.</p>

<p>One of the things I&#8217;d love to see fixed is the way the user&#8217;s password is stored - it&#8217;s currently stored in the <code>MyID.config.php</code> file as a MD5 hash - making brute-forcing entirely too easy. Hopefully <a href="http://tools.ietf.org/html/draft-ietf-httpauth-digest-06">this</a> Internet Draft will be adopted soon, obsoleting <a href="http://tools.ietf.org/html/rfc2617">RFC 2617</a>, which will be an easy win to improve the security of the password when in transit. There are many places where the code can be improved by somebody with a little time.</p>

<p>If you are using phpMyID today, replace the <code>MyID.php</code> file with the one <a href="https://raw.githubusercontent.com/adamcaudill/phpMyID/master/MyID.php">here</a> (it also fixes compatibility with PHP 5.4).</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/4/">&larr; Older</a>
    
    <a href="/archives/">Blog Archives</a>
    
    <a class="next" href="/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=250" class="aligncenter"></p>
  <p>I am an independant security researcher and software developer with more than 15 years of experience. I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p>
  <p>Email: <a href="mailto:adam@adamcaudill.com">adam@adamcaudill.com</a> (<a href="https://adamcaudill.com/pgp/">PGP</a>)</p>
</section>
<section>
  <h1>Links</h1>
	<ul>
		<li><a href="https://twitter.com/adamcaudill">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/adamcaudill">LinkedIn</a></li>
		<li><a href="https://github.com/adamcaudill">GitHub</a></li>
		<li><a href="http://www.flickr.com/people/adamcaudill/">Flickr</a></li>
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/01/03/utopia-found-utopia-lost/">Utopia Found; Utopia Lost</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/01/2014-a-year-in-review/">2014: Year In Review</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/20/irrational-attribution-apt3-dot-14159/">Irrational Attribution: APT3.14159</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/03/orwellian-justice/">Orwellian Justice</a>
      </li>
    
      <li class="post">
        <a href="/2014/11/23/speaking-at-sc-magazine-congress/">Speaking at SC Magazine Congress</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adamcaudill">@adamcaudill</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adamcaudill',
            count: 4,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Enjoy this site? Consider donating via Bitcoin to <strong>14jumFDmuVkLiAt4TgyKt17SWHtPRbkcLr</strong>.<br>
  Copyright &copy; 2015 - Adam Caudill -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
