
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adam Caudill</title>
  <meta name="author" content="Adam Caudill">

  
  <meta name="description" content="As it turns out, it&#8217;s quite easy to make your Android phone NSA-proof. It&#8217;s a simple method, and anyone can do it - all you need is a few &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://adamcaudill.com//page/6">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Caudill" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-106942-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Caudill</a></h1>
  
    <h2>Independent Security Researcher &amp; Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamcaudill.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/speaking/">Speaking</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/09/06/making-android-nsa-proof/">Making Android NSA-Proof</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-06T23:34:00-04:00" pubdate data-updated="true">Sep 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As it turns out, it&#8217;s quite easy to make your Android phone NSA-proof. It&#8217;s a simple method, and anyone can do it - all you need is a few ounces of thermite!</p>

<p><a href="https://secure.flickr.com/photos/pkh/578831120/"><img class="center" src="https://farm2.staticflickr.com/1341/578831120_8ee93c49af.jpg"></a></p>

<p>Too extreme?</p>

<p>Let&#8217;s shoot for something a little more attainable - spy resistant. We can&#8217;t stop every attack, but we can reduce the attack surface a bit. Here are a few tools that I&#8217;ve been using recently to do just that.</p>

<p><strong><a href="https://www.boxcryptor.com/en/boxcryptor-classic">Boxcryptor Classic</a></strong> - Like many people, I use DropBox for certain, low sensitivity files. But what about things that require a little more care? Boxcryptor Classic encrypts files and then stores the encrypted copy in DropBox. It&#8217;s simple, security seems sound, and the free edition is quite adequate. May not be perfect, but suits my needs nicely.</p>

<p><strong><a href="https://play.google.com/store/apps/details?id=org.thoughtcrime.securesms">TextSecure</a></strong> - It&#8217;s <a href="https://github.com/WhisperSystems/TextSecure/">open-source</a>, it&#8217;s free, and it&#8217;s from <a href="https://twitter.com/moxie">Moxie</a> - what&#8217;s not to love? It stores all of your SMS &amp; MMS data encrypted, and can encrypt the data over the air when texting another TextSecure user.</p>

<p>Currently it uses the SMS/MMS service for messaging, and is Android only; both of those things are changing soon. It&#8217;ll be using the <a href="https://whispersystems.org/blog/asynchronous-security/">data channel</a> and supporting <a href="https://whispersystems.org/blog/iphone-rsn/">iOS</a> in the near future.</p>

<p><strong><a href="https://play.google.com/store/apps/details?id=com.kaitenmail&amp;hl=en">Kaiten Mail</a> &amp; <a href="https://play.google.com/store/apps/details?id=org.thialfihar.android.apg&amp;hl=en">AGP</a></strong> - Kaiten is a low cost ($4.99) mail client; though if you want to go cheaper, it&#8217;s open-source cousin <a href="https://play.google.com/store/apps/details?id=com.fsck.k9&amp;hl=en">K-9 Mail</a> is free. They are developed by the same core team, though Kaiten seems to get the new features first, then they are ported into K-9. I like supporting OSS developers, so I happily went with the paid version. It works great with my Google Apps email account, though does take some getting used to.</p>

<p>Where it really comes in handy though, is when you use it with AGP, the Android Privacy Guard. It&#8217;s a simple, minimalistic OpenPGP tool that integrates nicely with Kaiten and K-9. It makes it simple to support encrypted or signed mail on your phone.</p>

<p>This does though require that your private key be on the device, so keep that risk in mind.</p>

<p>AGP is a bit dated, and hasn&#8217;t been updated since 2010. So, it&#8217;s  clearly been abandoned. Thankfully though, <a href="http://sufficientlysecure.org/">Dominik Sch√ºrmann</a> has <a href="https://github.com/dschuermann/openpgp-keychain">forked the project</a> and is working on a major update (new GUI, new API, etc.) that should be ready early next year.</p>

<p><strong><a href="https://play.google.com/store/apps/details?id=com.gmail.mjm4456.vpncilla&amp;hl=en">VpnCilla</a></strong> - Next up is a highly configurable VPN client ($4.99). WIFI is great - except that evil part of your traffic being so simple to monitor, and with recent work on <a href="http://www.theregister.co.uk/2013/07/15/femtocell_flaw_leaves_verizon_customers_wifi_and_mobile_wide_open/">femtocell systems</a>, even 3G/4G connections can&#8217;t be fully trusted. Having a VPN handy is a must.</p>

<p>You&#8217;ll also need a good VPN service; my current pick is <a href="http://www.atenlabs.com/zipline/">zipline</a>; it&#8217;s fast, cheap, and from a trusted professional (<a href="https://twitter.com/viss">Dan Tentler</a>).</p>

<p><strong><a href="https://play.google.com/store/apps/details?id=org.thoughtcrime.redphone&amp;hl=en">RedPhone</a></strong> - Another tool from Moxie, RedPhone secures your voice communications via encrypted VoIP. Or at least so I&#8217;ve read - I never actually make voice calls on my personal phone anymore.</p>

<p><strong>Others</strong> - There are various other useful things - Google Authenticator (2FA all the things, right?), ConnectBot to SSH into your server to do anything you don&#8217;t want to do from your phone, use wifitrack &amp; Wifi Analyzer to better understand what&#8217;s in your area.</p>

<p><strong>Configuration</strong></p>

<p>There is, of course, obvious configuration to make things a bit safer. Make sure you have a good password, or at least a long PIN set - don&#8217;t trust patterns, and don&#8217;t bother with a 4 digit PIN.</p>

<p>USB debugging <em>must</em> be turned off - otherwise there&#8217;s no point in locking your phone. Some other settings help, but not enough - one big one is Android&#8217;s full disk encryption.</p>

<div class='embed tweet'><blockquote class="twitter-tweet" align="center" width="350"><p>Hashkill now cracks Android FDE images master password. Speed is ~135k on 6870, ~270k/s on 7970. Android FDE is weak. <a href="http://t.co/mhcvEuEP48">pic.twitter.com/mhcvEuEP48</a></p>&mdash; gat3way (@gat3way) <a href="https://twitter.com/gat3way/statuses/328550698558029824">April 28, 2013</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


<p>If you only have a short numeric PIN, the FDE is little better than a wet paper bag.</p>

<p><strong>Weak Spots</strong></p>

<p>It&#8217;s not all great though, there are still weaknesses - plenty in fact. Thanks to USB MUXing there is probably a debug interface - and maybe even a full shell on your phone, and you have no way of turning it off. There may be flaws in the baseband or other software that could allow an attacker to gain control.</p>

<p>The list goes on and on. And that&#8217;s without the fact that your phone company hands over all of your call records, or the various apps you need, but don&#8217;t have a secure replacement.</p>

<p>There is no such thing as an NSA proof phone - unless you literally melt it. What we can do though is make it harder to be spied on; make the attackers work for every bit of data. Give nothing away for free.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/08/27/is-moving-offshore-really-crazy/">Is Moving Offshore Really Crazy?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-27T18:49:00-04:00" pubdate data-updated="true">Aug 27<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today ZDNet published an article titled &#8221;<a href="http://www.zdnet.com/the-lunacy-of-trying-to-avoid-nsa-spying-by-moving-e-mail-and-cloud-out-of-the-us-7000019908/">The lunacy of trying to avoid NSA spying by moving e-mail and cloud out of the US</a>&#8221; - I&#8217;m still trying to figure out if the position is naive, or intentionally ignores important facts.</p>

<p>In short, the author (<a href="http://www.zdnet.com/meet-the-team/us/steven-j-vaughan-nichols/">Steven J. Vaughan-Nichols</a>) states that your data is safer in the US because outside of the US, the NSA has much less restrictive rules to operate under. This is actually true - the NSA is a spy agency; like most spy agencies, they spy on people.</p>

<p>For those outside of the US, or those that routinely communicate  with those that are outside of the US - as far as the NSA goes, you are fair game. Anything and everything you do, if they can see it, they&#8217;ll use. So on that point, ZDNet was right.</p>

<p>But their points only hold true if you ignore cryptography.</p>

<p>When your data is outside the US, you have to rely on encryption to protect your data; inside the US you have to rely on <a href="https://epic.org/privacy/terrorism/fisa/fisc.html">FISC</a> to protect you. The <a href="http://arstechnica.com/tech-policy/2013/08/how-might-the-feds-have-snooped-on-lavabit/">Lavabit affair</a> (or Hushmail if you want another example) should make it clear that inside the US, encrypted data held by a third-party shouldn&#8217;t be seen as secure as it once was - for that matter, it probably shouldn&#8217;t be viewed as secure at all (if your adversary is the US Government; in which case, you don&#8217;t have much hope anyway).</p>

<p>When somebody posted a link to the article, I made my point short and sweet:</p>

<div class='embed tweet'><blockquote class="twitter-tweet" align="center" width="350"><p><a href="https://twitter.com/gattaca">@gattaca</a> It&#39;s a lot harder to break crypto than it is to order a provider to just hand over the data. With good crypto, offshore is safer.</p>&mdash; Adam Caudill (@adamcaudill) <a href="https://twitter.com/adamcaudill/statuses/372469441922998272">August 27, 2013</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


<p>It&#8217;s hard to break properly implemented, strong cryptography - on the other hand, getting FISC to order a provider to hand over your data seems to be <a href="https://www.eff.org/deeplinks/2013/08/nsa-spying-three-pillars-government-trust-have-fallen">quite simple</a>. Given the choice of relying on encryption or a rubber-stamp court to protect my data - the right choice seems obvious.</p>

<p>Now, in all fairness, it&#8217;s worth noting that the NSA likes to collect and examine encrypted communication more than other things - and the odds of your data passing through the NSA is certainly higher if your data is offshore. If properly encrypted though, the odds of them seeing the content is reduced.</p>

<p>So is it insane to move data offshore to avoid the NSA? If you want them to not see anything you do, then yes, yes it is. If you want to reduce the odds of them seeing the content - it&#8217;s actually a reasonably prudent move.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/08/26/hash-storage-make-attackers-work/">Hash Storage: Make Attackers Work</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-26T18:49:00-04:00" pubdate data-updated="true">Aug 26<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So you hash your passwords? Good. Do you salt? That&#8217;s good. Do you use a strong hashing algorithm (PBKDF2/bcrypt/scrypt)? Great! But how do you store the hashes? What happens when you get hit with a SQL injection attack?</p>

<p>I&#8217;m a big believer in defense in depth - not that marketing garbage about staking layers of blinky-light boxes, but using techniques to add extra work for an attacker. You might not be able to stop every attack, but the more work they have to do, the better the odds they won&#8217;t get everything they want.</p>

<p>So, let me describe a scenario:</p>

<p>$company stores passwords as <code>SHA1(password + salt)</code> hashes (terrible, I know - but still common). They install a new web application that connects to their main database - this new application has a previously undisclosed flaw, SQL injection.</p>

<p>$evil_hacker finds this flaw and looks for companies that use the application; finds $company, exploits, dumps their user table and posts the hashes on PasteBin. Having both the hash and salt, those hashes will fall <em>quickly</em>.</p>

<p>We&#8217;ve all seen it before - far too many times.</p>

<p>Now, let me modify the scenario slightly: instead of <code>SHA1(password + salt)</code>, make it <code>AES128(salt : SHA1(password + salt), key)</code> - where <code>key</code> is an application secret.</p>

<p>Now, we have a different story - as long as the application secret remains secret, the hashes are safe. Stored in the clear, they will fall quickly - encrypted, they are safe as long as the secret remains safe.</p>

<p>In the case of many SQL injection attacks, the attacker is able to access the data, but doesn&#8217;t have access to the application source code. In these cases, you can add a few extra milliseconds to processing time and as a result stop attackers from using stolen data from a entire class of attacks. There&#8217;s nothing new about this idea - but I don&#8217;t see it used nearly often enough.</p>

<p>Obviously this doesn&#8217;t help if the attacker is able to retrieve the source code, so you still need to use a strong hashing algorithm. Encrypting a strong hash buys you extra protection against certain attacks, and maintains a strong baseline against  others - at a very small performance cost.</p>

<p>In case of a breach, I would still assume that the attacker knows the encryption key, and reset passwords accordingly. Seeing as it takes time to find out the extent of the breach, it&#8217;s safest to act as if the attacker has everything and limit the damage as quickly as possible. In reality though, the odds of the passwords being exposed as a result of a SQL injection attack is reduced significantly thanks to the added encryption layer.</p>

<p>Storing the data like this keeps everything secure, and in a single field (and makes it easy to integrate into existing applications):</p>

<p><code>&lt;IV&gt;:AES128(&lt;salt&gt;:HASH(&lt;password&gt;&lt;salt&gt;))</code></p>

<p>This way all of the material needed is encrypted; though it could be argued that just encrypting the hash or the salt would be sufficient (assuming the salt is at least 16 bytes and generated by a CSPRNG). The core idea here is to deny the attacker of as much information as possible; making it as difficult as possible to find passwords.</p>

<p>There are no <a href="http://adamcaudill.com/2013/05/07/password-hashing-no-silver-bullets/">silver bullets</a>, but we can take advantage of the tools we have to make attackers work harder to get our secrets.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/16/cryptocat-what-is-the-measure/">Cryptocat: What Is the Measure&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-16T19:05:00-04:00" pubdate data-updated="true">Jul 16<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>What is the measure of a man; what makes one great, and another lesser? What separates success from failure? We all recognize light from dark, but at which point does it go from one to another? If we ask if a person (or company, or product) is successful - do we measure them against their closest competitor, their nearest neighbor, or perhaps the most successful person we know? Where, and how, do you set that bar to measure against?</p>

<p>Yesterday I talked to <a href="http://nadim.cc/">Nadim Kobeissi</a> for about an hour about Cryptocat, its policies, practices, successes, failures, and goals. The topic of goals led to an interesting discussion - to what standard is Cryptocat being held? Perhaps, just perhaps - the unforgivable security failures of Cryptocat are only so unforgivable because of the bar it&#8217;s being measured against.</p>

<blockquote><p>[this] is a crucible; in it we burn away irrelevancies until we are left with a pure product: the truth, for all time.</p></blockquote>


<p>So, what it the true goal? Here is a snippet of their <a href="https://github.com/cryptocat/cryptocat/blob/master/README.md">readme</a>, which (kinda) lays out the goal:</p>

<pre><code>Cryptocat is an experimental browser-based chat client for easy to use, encrypted conversations. 
It aims to make encrypted, private chat easy to use and accessible. We want to break down the 
barrier that prevents the general public from having an accessible privacy alternative that 
they already know how to use. Cryptocat is currently available for Chrome, Firefox and Safari.
</code></pre>

<p>The second sentence is the one that I find interesting, in light of the conversation I had yesterday; primarily this part: <em>an accessible privacy alternative that they already know how to use</em>. I asked Nadim at one point what his goal was, he responded without hesitation: to provide a safer alternative to Facebook Chat, Google Talk, etc..</p>

<p>When I asked about Cryptocat&#8217;s reputation as a tool for activists, he was clearly agitated and made his position on the matter very clear. That isn&#8217;t the intention, and he acknowledged that it&#8217;s not safe for that use. He then pointed me to a <a href="https://blog.crypto.cat/2012/11/security-update-a-follow-up/">quote on their blog</a>:</p>

<blockquote><p>We have realized that due to some (perhaps well-meaning) media coverage of the Cryptocat Project, our work has been labeled by the media as something that can aid activists in overthrowing governments or help save someone‚Äôs life. This is not what Cryptocat is, it is wrong for the media to say that, and we have never said anything to that effect ourselves.</p></blockquote>


<p>Though I will note, the initial feeling seemed to be a bit different:</p>

<div class='embed tweet'><blockquote class="twitter-tweet" align="center" width="350"><p>Cryptocat featured in Wired! <a href="http://t.co/Aj45zedr">http://t.co/Aj45zedr</a></p>&mdash; Cryptocat (@cryptocatapp) <a href="https://twitter.com/cryptocatapp/statuses/228921660324061184">July 27, 2012</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


<p><strong>So, where does this leave us?</strong></p>

<p>The <a href="http://tobtu.com/decryptocat.php">most recent flaw</a> was bad, very, very bad. <em>If</em> you understand encryption, the protection afforded was far less than expected. Let&#8217;s look at it from another perspective though: Compared to Facebook Chat. While the bug was bad, how does it compare to other consumer chat systems, even with that flaw in mind? From what I&#8217;ve seen, it&#8217;s still a better option than Facebook.</p>

<p>First, let&#8217;s ignore encryption and just look at what we get from SSL/TLS:</p>

<p><a href="https://www.ssllabs.com/ssltest/analyze.html?d=facebook.com&amp;s=173.252.110.27">Facebook</a>:</p>

<p><img class="center" src="/files/Qualys_SSL_Labs_-_Projects___SSL_Server_Test___facebook.com.png"></p>

<p><a href="https://www.ssllabs.com/ssltest/analyze.html?d=crypto.cat">Cryptocat</a>:</p>

<p><img class="center" src="/files/Qualys_SSL_Labs_-_Projects___SSL_Server_Test___crypto.cat.png"></p>

<p>First thing that I can point out is the use of <a href="https://community.qualys.com/blogs/securitylabs/2013/06/25/ssl-labs-deploying-forward-secrecy">forward secrecy</a> - something Facebook isn&#8217;t using (<a href="http://news.cnet.com/8301-13578_3-57591179-38/data-meet-spies-the-unfinished-state-of-web-crypto/">yet</a>). So, if you just look at SSL/TLS, Cryptocat is better - assuming nobody else has access to the ciphertext, which <a href="https://blog.crypto.cat/2012/11/security-update-our-first-full-audit/">happened</a> (at least) when they used Cloudflare.</p>

<p>How about data retention? While in the past Facebook has said messages are <a href="http://news.cnet.com/8301-13577_3-9896860-36.html">cleared after 90 days</a>, it&#8217;s not clear how long they retain the information today, or how much could be produced under subpoena - it&#8217;s clearly more than what <a href="https://blog.crypto.cat/2013/05/responding-to-law-enforcement-requests/">Cryptocat can</a> produce (as Facebook <a href="http://info.publicintelligence.net/Facebook2010.pdf">produces a lot</a>). Just looking at what Facebook can provide, versus what Cryptocat can says a lot from a privacy perspective.</p>

<p>I could go through more details, or compare it in more detail to other services, but the basic point should remain.</p>

<p>From that perspective, I think Cryptocat has accomplished something - it may not be ideal, and has clearly been far from it; it&#8217;s still a better choice for casual communication than most (all?) of the major IM/chat players.</p>

<p><strong>&#8216;I thought you said don&#8217;t use it?&#8217;</strong></p>

<p>In an <a href="http://arstechnica.com/security/2013/07/bad-kitty-rooky-mistake-in-cryptocat-chat-app-makes-cracking-a-snap/">article</a> I was quoted as saying something like this:</p>

<blockquote><p>He went on to recommend people not rely on Cryptocat to keep their conversations private until the code and the cryptography in it are thoroughly audited by professional penetration testers and cryptographers.</p></blockquote>


<p>I stand by that statement. If you <em>need</em> security, Cryptocat isn&#8217;t what you should be using, period. If you <em>want</em> privacy, it&#8217;s not a bad option. In a discussion on Twitter, the agreement was that there are no real competitors that provide secure multi-party chat - for those that want that feature, Cryptocat seems to be the only option.</p>

<p>It&#8217;s worth pointing out though, if you&#8217;re reading this, you probably know how to use PGP - and can use that to get around Cryptocat&#8217;s use-case. I&#8217;m not an apologist, and I&#8217;m not trying to excuse serious mistakes - I&#8217;m trying to present the issue, and the system itself in a fair light for the intended use-case, as Nadim explained it. In that light, the system still achieves its basic goal.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/04/do-one-thing-right/">Do One Thing Right&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-04T10:45:00-04:00" pubdate data-updated="true">Jul 4<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Everybody&#8217;s favorite whipping boy, <a href="https://crypto.cat/">Cryptocat</a> is back in the news today - and it&#8217;s <em>bad</em>. Really bad. Steve Thomas has <a href="http://tobtu.com/decryptocat.php">found</a> a major flaw in the way Cryptocat generated ECC keys. Due to this flaw, the keyspace was only <code>2^54.15</code>, well below a secure level. Add a <a href="http://en.wikipedia.org/wiki/Meet-in-the-middle_attack">meet in the middle</a> attack, and this is further reduced to <code>2^27.08</code> - which based on my rough estimates, is just slightly more secure than a paper bag.</p>

<p>The end result is of course, that anyone can crack the keys in a frighteningly short amount of time.</p>

<p>This flaw basically means that any group messages sent for nearly a year (a figure <a href="https://blog.crypto.cat/2013/07/new-critical-vulnerability-in-cryptocat-details/">disputed</a> by the project) are wide open to attack. Personally, I would operate under the assumption that any message sent during that time has been read (or will be) - hopefully by somebody not interested in you. Probably hasn&#8217;t, but there&#8217;s no way to know.</p>

<p><strong>If you&#8217;re going to do one thing, do it right.</strong></p>

<p>Cryptocat has one mission, to provide secure communication - which is to say, to encrypt data. The most vital step in any crypto system is the key generation; if you get it wrong, nothing else matters. That code should be well reviewed and understood by multiple people. Cryptocat got this wrong.</p>

<p>Steve does a great job explaining the issue here; but the short version is that the person that wrote the code - and anyone that&#8217;s reviewed it since then, didn&#8217;t understand what they were doing. That simple.</p>

<p>When you release code like this to the public, and encourage people to use it - especially those that are at higher risk (i.e. activists), you take on a certain responsibility for ensuring that at least the core functionality is doing what&#8217;s expected. In this case, the team behind Cryptocat failed. For a year, the entire user base was at risk.</p>

<p>I recently mentioned Cryptocat in my <a href="http://adamcaudill.com/2013/06/19/opsec-the-nsa-and-you/">OPSEC</a> article:</p>

<blockquote><p>Last year was painful for Cryptocat - the last audit may have been clean, but who knows what else may be found.</p></blockquote>


<p>When I wrote that, I wasn&#8217;t expecting it to be a bug that rendered the group chat encryption nearly pointless. While in <a href="https://blog.crypto.cat/2013/07/new-critical-vulnerability-in-cryptocat-details/">their</a> blog post they seem to downplay the issue, I won&#8217;t - for a year, group chat was <em>completely broken</em>.</p>

<p><strong>Crypto Is Hard</strong></p>

<p>There&#8217;s no doubt that crypto is hard, everybody agrees on that. Or said more accurately, doing it right is hard.</p>

<div class='embed tweet'><blockquote class="twitter-tweet" align="center" width="350"><p>Having spent the past month doing it, let me tell you: implementing cryptography is *hard*. Even for &#39;experts&#39;.</p>&mdash; Matthew Green (@matthew_d_green) <a href="https://twitter.com/matthew_d_green/statuses/352815917924757505">July 4, 2013</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


<p>Writing key generation code scares me, I&#8217;m paranoid that I&#8217;ll get it wrong. So I take extra time to review it in detail. Then have other people review it in detail. I don&#8217;t release it to a &#8216;production&#8217; environment until I&#8217;m sure as I can be that it&#8217;s right. Can mistakes still make it in that way? Sure - but the odds are a lot lower.</p>

<p>This kind of code needs to be reviewed by those competent in crypto systems, and built to a specification that was designed by a real cryptographer. It can be expensive and time consuming, but that&#8217;s what it takes to keep the promises an application like Cryptocat makes.</p>

<div class='embed tweet'><blockquote class="twitter-tweet" align="center" width="350"><p>The problem: cryptographers aren&#39;t developers &amp; developers aren&#39;t cryptographers. The right solution is probably some Avengers-style mashup.</p>&mdash; Matthew Green (@matthew_d_green) <a href="https://twitter.com/matthew_d_green/statuses/352816626170728450">July 4, 2013</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


<p><strong>Just how bad could it be?</strong></p>

<p>Based on recent disclosures, we know that the NSA has decided to store encrypted communication for later analysis, and I think it&#8217;s safe to say that other countries follow suit. So it&#8217;s likely there are stored Cryptocat communications floating around in various spy agency archives. These agencies may have already found this issue and used it to view messages, or now that it&#8217;s public - they can do so easily.</p>

<p>This is where an issue like this can be so devastating, if those encrypted messages have been saved anywhere - any users engaged in activity that their local government doesn&#8217;t care for are now at risk.</p>

<p>Personally, I wouldn&#8217;t trust Cryptocat until it&#8217;s had a true code audit (the pen-test they had last year clearly doesn&#8217;t count), and the crypto systems reviewed by a true cryptographer. If a mistake like this was allowed in, and overlooked for so long, I&#8217;ve no doubt that other weaknesses exist.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/7/">&larr; Older</a>
    
    <a href="/archives/">Blog Archives</a>
    
    <a class="next" href="/page/5/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=250" class="aligncenter"></p>
  <p>I am an independant security researcher and software developer with more than 15 years of experience. I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p>
  <p>Email: <a href="mailto:adam@adamcaudill.com">adam@adamcaudill.com</a> (<a href="https://adamcaudill.com/pgp/">PGP</a>)</p>
</section>
<section>
  <h1>Links</h1>
	<ul>
		<li><a href="https://twitter.com/adamcaudill">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/adamcaudill">LinkedIn</a></li>
		<li><a href="https://github.com/adamcaudill">GitHub</a></li>
		<li><a href="http://www.flickr.com/people/adamcaudill/">Flickr</a></li>
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/04/13/crypto-front-door-everyone-welcome/">Crypto Front Door: Everyone Welcome!</a>
      </li>
    
      <li class="post">
        <a href="/2015/03/08/on-the-underhanded-crypto-contest/">On the Underhanded Crypto Contest</a>
      </li>
    
      <li class="post">
        <a href="/2015/02/17/the-evolution-of-paranoia/">The Evolution of Paranoia</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/12/religion-free-speech-freedom-from-offense/">Religion, Free Speech & Freedom from Offense</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/03/utopia-found-utopia-lost/">Utopia Found; Utopia Lost</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adamcaudill">@adamcaudill</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adamcaudill',
            count: 4,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Enjoy this site? Consider donating via Bitcoin to <strong>14jumFDmuVkLiAt4TgyKt17SWHtPRbkcLr</strong>.<br>
  Copyright &copy; 2015 - Adam Caudill -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
