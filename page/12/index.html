
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adam Caudill</title>
  <meta name="author" content="Adam Caudill">

  
  <meta name="description" content="Continuing my long tradition of frequent host changes, this site has been moved to yet another host. In the last few years I&#8217;ve used a number &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://adamcaudill.com//page/12">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Caudill" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-106942-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Caudill</a></h1>
  
    <h2>Independent Security Researcher &amp; Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamcaudill.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/04/05/quickpacket-hosting/">QuickPacket Hosting</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-05T02:00:21-04:00" pubdate data-updated="true">Apr 5<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Continuing my long tradition of frequent host changes, this site has been moved to yet another host. In the last few years I&#8217;ve used a <a href="http://adamcaudill.com/2009/06/13/switching-hosts-again/">number of hosts</a> (and there&#8217;s a couple more not on that list), and this time I&#8217;m taking a bit of a risk - so it&#8217;ll be interesting to see how this one works out. I&#8217;ve switched to a company called <a href="https://www.quickpacket.com/">QuickPacket</a>, but this time instead of a fairly beefy VPS, I&#8217;ve went in the opposite direction - absolute minimum.</p>

<p>The new plan is about as minimal as it gets:</p>

<ul>
<li><p>128 MB RAM</p></li>
<li><p>256 MB vSwap</p></li>
<li><p>1 CPU Cores</p></li>
<li><p>20 GB Disk Space</p></li>
<li><p>500 GB Bandwidth</p></li>
</ul>


<p>The upside to this? It&#8217;s only <a href="http://www.lowendbox.com/blog/quickpacket-4-99m-128mb-xen-in-atlanta-ga-san-jose-ca-openvz-also-available/">$15 per year</a>.</p>

<p>So I&#8217;m going to focus on caching and optimization to keep this and a few other sites running on such lean resources. In theory WordPress should be able to do it, if it can&#8217;t - I&#8217;ll switch to <a href="http://octopress.org/">Octopress</a> or something similar.</p>

<p>This should be a fun challenge.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/03/31/my-5-minutes-of-infamy/">My 5 Minutes of Infamy</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-31T01:19:23-04:00" pubdate data-updated="true">Mar 31<span>st</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>October 28, 2004 is a day I&#8217;ll remember for the rest of my life.</p>

<p>I was coding away on the next version of a small product called GSuite that I was building for a tiny (and now nonexistent) software company called Imspire Software. It was a simple tool that provided some goodies for Gmail users, and had a few thousand users (it eventually died as a result of rapid API changes and new tools directly from Google). As I took a break to check my email, I saw something that shocked me:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>###############################################
</span><span class='line'>######    Gmail suit decripting password     ##########
</span><span class='line'>###############################################
</span><span class='line'>os:win 2000 sp 4 ie 6.x whith all fixes
</span><span class='line'>vendor url:http://www.imspire.com/gsuite/index.html
</span><span class='line'>impact: disclosure user information decript password
</span><span class='line'>
</span><span class='line'>gmail suit is an application that offers different utilities for
</span><span class='line'>contextual gmail and adds menus our explorer for as much being able to
</span><span class='line'>consult as to send post office to gmail from this suit
</span><span class='line'>
</span><span class='line'>Gmail suit once installed leaves in the user folder:
</span><span class='line'>(documents and settings\user_name\Application Data\GSuit\) creates a
</span><span class='line'>called file 'settings.xml' if we watched within this file we see
</span><span class='line'>several data:
</span><span class='line'>
</span><span class='line'>&lt;configuration&gt;
</span><span class='line'>&lt;User&gt;
</span><span class='line'>  &lt;Email&gt;User_name_login&lt;/Email&gt;
</span><span class='line'>  &lt;Password&gt;ìóåPassword&gt;
</span><span class='line'>&lt;/User&gt;
</span><span class='line'>&lt;/configuration&gt;
</span><span class='line'>
</span><span class='line'>1 name of user of the account of gmail
</span><span class='line'>2 password codified
</span><span class='line'>
</span><span class='line'>somehow password codified has the same length of characters that
</span><span class='line'>password in flat text introduced by the  user to know like decoding as
</span><span class='line'>simple the one whom serious as to pass character through character to
</span><span class='line'>its 128 to him value ASCII(http://www.bbsinc.com/symbol.html) of
</span><span class='line'>reducing and the turn out to watch in table ASCII and we will have the
</span><span class='line'>correct character of password
</span><span class='line'>
</span><span class='line'>example:
</span><span class='line'>
</span><span class='line'>ì236-128)=108
</span><span class='line'>108 = a
</span><span class='line'>
</span><span class='line'>another
</span><span class='line'>
</span><span class='line'>á225-128)=97
</span><span class='line'>97=a
</span><span class='line'>
</span><span class='line'>ìóå loislane
</span><span class='line'>
</span><span class='line'>atentamente:
</span><span class='line'>
</span><span class='line'>Lostmon (lostmon(at)gmail.com)</span></code></pre></td></tr></table></div></figure>


<p>[The full email is still <a href="http://osvdb.org/ref/11/11176-gsuite.txt">posted</a> over at osvdb, and I make a point to go and look at it and the <a href="http://osvdb.org/show/osvdb/11176">details</a> once a year or so - just to remind myself of what can happen.]</p>

<p>As I worked through the somewhat iffy English of the email I was in shock. I instantly understood the issue, I could see the code in my mind. It was written by another developer, and I could remember questioning its security - but I had other things I was supposed to be doing and didn&#8217;t worry about it. What a mistake that was.</p>

<p>I went back to Visual Studio and found the code that caused it all:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">Crypt</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">strText</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">strTempChar</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span><span class='line'>    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">Len</span><span class="p">(</span><span class="n">strText</span><span class="p">)</span>
</span><span class='line'>        <span class="k">If</span> <span class="n">Asc</span><span class="p">(</span><span class="n">Mid$</span><span class="p">(</span><span class="n">strText</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">strTempChar</span> <span class="o">=</span> <span class="n">_</span>
</span><span class='line'>      <span class="k">CType</span><span class="p">(</span><span class="n">Asc</span><span class="p">(</span><span class="n">Mid$</span><span class="p">(</span><span class="n">strText</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">128</span><span class="p">,</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>        <span class="k">ElseIf</span> <span class="n">Asc</span><span class="p">(</span><span class="n">Mid$</span><span class="p">(</span><span class="n">strText</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">128</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">strTempChar</span> <span class="o">=</span> <span class="n">_</span>
</span><span class='line'>      <span class="k">CType</span><span class="p">(</span><span class="n">Asc</span><span class="p">(</span><span class="n">Mid$</span><span class="p">(</span><span class="n">strText</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">128</span><span class="p">,</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>        <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>        <span class="n">Mid$</span><span class="p">(</span><span class="n">strText</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">_</span>
</span><span class='line'>            <span class="n">Chr</span><span class="p">(</span><span class="k">CType</span><span class="p">(</span><span class="n">strTempChar</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">))</span>
</span><span class='line'>    <span class="k">Next</span> <span class="n">i</span>
</span><span class='line'>    <span class="k">Return</span> <span class="n">strText</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure>


<p>Shifting values is obfuscation and little more, it looks like security - it might even smell like security, but it isn&#8217;t. It&#8217;s a false sense of safety, it was a mistake to implement and even more of a mistake to actually use in a consumer product.</p>

<p>While this is only a local information disclosure, and not something far more serious like a remote arbitrary code execution issue - it was still enough to really shake me. I had always considered myself to be a good developer, and part of that is writing secure code. This was many things - but secure isn&#8217;t one of them.</p>

<p>Thankfully, <a href="http://lostmon.blogspot.com/">Lostmon</a>, the finder of the issue was courteous enough to give me a couple of days advance notice before making it public. Allowing me plenty of time to get a notice up on the web site, and get the next (fixed) version ready for release. I switched from a glorified <a href="http://en.wikipedia.org/wiki/Caesar_cipher">Caesar cipher</a>, to <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Rijndael</a> - a significant step up I would say.</p>

<p>Was anybody harmed by this issue? I don&#8217;t believe so - it was a relativity minor issue given what was needed to get the password. Was anybody impacted? Most certainly.</p>

<ul>
<li>Users: They now wonder if they are secure - did somebody steal their information?</li>
<li>Company: The brand is weakened, less trusted, and questioned more.</li>
<li>Developers: Confidence is lost, self doubts start creeping in.</li>
</ul>


<p>Because of this, every time I release an application I give much more thought to what I&#8217;m exposing and how it could be leveraged in an attack against my users. The only way I&#8217;ll agree to an application release is if I&#8217;m completely certain that I&#8217;m not risking a user&#8217;s security - if there are any unknowns, any doubts, then it&#8217;s not worth the risk. Just that simple.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/02/29/ccsrch-v1-0-7/">CCSRCH v1.0.7</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-29T23:47:17-05:00" pubdate data-updated="true">Feb 29<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve released a new version of <a href="https://github.com/adamcaudill/ccsrch">CCSRCH</a>, the open-source PAN (a.k.a credit card number) search tool to help companies maintain PCI compliance. This is a fairly minor release, primarily focusing on reducing false positives. The scanner has been updated to exclude the following:</p>

<ul>
<li><p>Results made up of the same two digits repeating (i.e. 5454545454545454).</p></li>
<li><p>Results that have seven or more of the same digits repeating (i.e. 5555555555554444).</p></li>
</ul>


<p>I also fixed a bug that I introduced in v1.0.6 that prevented it from compiling on certain *nix systems; while I was in there I also fixed several instances of this building warning on newer Linux distros:</p>

<pre><code>warning: call to __builtin___strncat_chk might overflow destination buffer
 [enabled by default]
</code></pre>

<p>I also took the time to write-up really simple build instructions for *nix users:</p>

<pre><code>$ wget -O ccsrch.tar.gz https://github.com/adamcaudill/ccsrch/tarball/master
$ tar -xvzf ccsrch.tar.gz
$ cd adamcaudill-ccsrch-&lt;rev&gt;/
$ make all
</code></pre>

<p>This will probably be the last release for now unless a bug turns up; to improve results further I&#8217;m working on a new project (<a href="https://github.com/adamcaudill/ccsrch-score">ccsrch-score</a>), hopefully it&#8217;ll be released soon.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/01/26/iin-bin-database/">IIN (BIN) Database</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-26T12:58:28-05:00" pubdate data-updated="true">Jan 26<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>An <a href="http://en.wikipedia.org/wiki/ISO/IEC_7812">Issuer Identification Number</a> (IIN, more commonly called a BIN) is the first 6 digits of a credit or debit card, and it identifies the bank that issued it - and if you want to know if a number is a real credit card or just a bunch or random digits, it&#8217;s a huge help. While credit card numbers do use the <a href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn algorithm</a> (mod 10 check) to see if the number is valid, it still produces a huge false-positive rate.</p>

<p>For an application like <a href="https://github.com/adamcaudill/ccsrch">ccsrch</a>, having this data available would be very handy to reduce false positives when scanning a large file system (scanning a large server produces a huge number of possible hits), but for what I would call fairly misguided reasons, the official registrar of these numbers (the <a href="http://www.aba.com/default.htm">ABA</a>) doesn&#8217;t make this data publicly available. As a result many people have pulled together what data they could find and made it freely available.</p>

<p>So I&#8217;ll add my name to that list.</p>

<p>I&#8217;ve pulled data from many public sources (sorry, I didn&#8217;t keep very good notes as to the sources) and cleaned it up to a reasonable point. All told, I&#8217;ve probably spent 40 hours or more cleaning this data up and getting it to a usable state. It contains over 60,000 entries, including major credit cards (Visa, MasterCard, Amex, Discover) as well as a few merchant entries.</p>

<p>Each record contains the following:</p>

<ul>
<li><p>IIN</p></li>
<li><p>Type (Mastercard, Visa, Visa Credit, etc.)</p></li>
<li><p>Name (Issuer name)</p></li>
<li><p>Length</p></li>
</ul>


<p><strong>Data Quality</strong></p>

<p>It&#8217;s not perfect. It&#8217;s from public sources so there may be errors, and there are some duplicates from cases where I wasn&#8217;t able to determine who the IIN actually belongs to. I&#8217;ve also updated for name changes and mergers where possible, but I&#8217;m sure I&#8217;ve missed a few and there are some where the assets where split, so I don&#8217;t know who the correct owner actually is (Washing Mutual being the leading example of this).</p>

<p>In general, I leaned to the side of caution - so if I didn&#8217;t know for sure, I left the duplicate in.</p>

<p>If you need absolutely correct data - contact the ABA, they are the only source that can give you the completely accurate listing. If you need to have a decent idea if a number is valid for most cases - I would say that this data is good enough.</p>

<p><strong>Warranty</strong></p>

<p>Just to make it really, really, really clear: There is no guarantee that this data is accurate, that it won&#8217;t cause to lose your job, cause your house to burn down, or cause Rebecca Black&#8217;s <a href="http://www.youtube.com/watch?v=kfVsfOSbJY0">Friday</a> to get stuck in your head (yup, you&#8217;re welcome ;)).</p>

<p><strong>Copyright</strong></p>

<p>Based on my understanding of US copyright law, it is my understanding that this data is not subject to copyright as it is a compilation of facts and doesn&#8217;t constitute an original expression. Thus, to the best of my knowledge, this data is in the public domain.</p>

<p><strong>Download</strong></p>

<p><a href="http://adamcaudill.com/files/2012/01/IIN.zip">Here</a> (zipped CSV)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/01/23/poking-mykonos/">Poking Mykonos</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-23T22:28:56-05:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While checking on the latest updates in the start-up world from TechCrunch, I came across <a href="http://techcrunch.com/2012/01/23/mykonos-helps-companies-battle-hackers-raises-4-million/">their article</a> on <a href="http://www.mykonossoftware.com/">Mykonos</a>; the important part of their article (at least for me), is this:</p>

<p><em>Mykonos’s Web Security product uses deception to “detect, confuse, slow down and prevent attackers” in real-time in order to help companies protect their websites and Web apps from malicious hacker and proactively prevent fraud and theft.</em></p>

<p>A couple of minutes of reading, and my interest was piqued - to say the least. The thing that most interested me was the claim of no false positives, while they do <a href="http://www.mykonossoftware.com/early-detection.php">talk about it</a> - I really wanted to see it for myself. Assuming they used their own product to protect their site, I took a few minutes to see what I could find - and find I did.</p>

<p>The first thing I did was a view-source to see what I could learn about their site - mainly to see if there were any obvious signs of using one CMS or another. The first thing that jumps out at me is this from the HTML:</p>

<pre><code>&lt;!-- InstanceBegin template="/Templates/mykonos.dwt.php"
     codeOutsideHTMLIsLocked="false" --&gt;
</code></pre>

<p>So, this tells us they are using Dreamweaver, and the name of the template. So, the next question is, does that <a href="http://www.mykonossoftware.com/Templates/"><code>/Templates/</code></a> directory exist on the server?</p>

<p><img src="http://adamcaudill.com/files/2012-01-23_1930.png" alt="File Listing" /></p>

<p>Yup.</p>

<p>So, not only does it exist, they have directory listings turned on - which to me was a real shock. Unfortunately for us though, these files are named with the <code>.php</code> extension and not the <code>.dwt</code> I was hoping for, so we can&#8217;t get much useful from them.</p>

<p>So, from looking at the source of the home page, we can see that the css files are stored in a <a href="http://www.mykonossoftware.com/css/">/css/</a> directory - maybe that&#8217;ll be interesting.</p>

<p><img src="http://adamcaudill.com/files/2012-01-23_1935.png" alt="File Listing" /></p>

<p>It&#8217;s there, and like last time, we can see all of the files. While CSS files are of no real interest, the <a href="http://www.mykonossoftware.com/css/_notes/">/_notes/</a> directory is, because it&#8217;ll contain a file called <code>dwsync.xml</code> - which can be quite interesting (since we knew they are using Dreamweaver, it&#8217;s not too surprising to see this). This file contains data about the last time the site was pushed from Dreamweaver, and will contain one entry per file, and looks like this:</p>

<pre><code>&lt;file name="style.css"
 server="ftp.belincreative.com/public_html/clients/mykonos/site/"
 local="129651858311162109"
 remote="129651936600000000"/&gt;
</code></pre>

<p>The most interesting thing there is the <code>server</code> entry, as it tells us a little about the file-system; which if we were really trying to attack the site, knowing that would be handy. The other thing of interest is that when you see one <code>/_notes/</code> directory, you&#8217;ll see lots more, as Dreamweaver likes to put them everywhere.</p>

<p>So, let&#8217;s see if there&#8217;s one in the root - that should be the most interesting one. Sure enough: <a href="http://www.mykonossoftware.com/_notes/">/_notes/</a></p>

<p><img src="http://adamcaudill.com/files/2012-01-23_1949.png" alt="" /></p>

<p>This one has a few interesting entries, such as a <a href="http://www.mykonossoftware.com/TechSpecsWhatsNew.html">PHP file</a> that is named with an HTML extension - causing the code not to execute. Viewing the source of that file in the browser exposes the <a href="http://www.mykonossoftware.com/inc/">/inc/</a> directory; potentially interesting, but yields little information. The next file I tried (knowing it would be way too easy if it worked), was the <a href="http://www.mykonossoftware.com/.htaccess">.htaccess</a> file:</p>

<pre><code>&lt;files "webadmin.pl"&gt;
    AuthUserFile /usr/local/www/public_html/.htpasswd
    AuthType Basic
    AuthName "Server Administration"
    require valid-user
&lt;/files&gt;
</code></pre>

<p>Now, at first glance things look too good to be true - and that&#8217;s because they are. Look at the path in <code>AuthUserFile</code> and compare that to the entries from the <code>dwsync.xml</code> files. This <code>.htaccess</code> file is part of the trap, which is all but confirmed if you try to go to the <a href="http://www.mykonossoftware.com/.htpasswd">.htpasswd</a> file which shouldn&#8217;t work, since the path isn&#8217;t what we would expect.</p>

<p>Now, while mucking around looking at the aforementioned files, and others such as <a href="http://www.mykonossoftware.com/robots.txt">robots.txt</a>, I would periodically see this, which I would assume is part of that &#8220;no false positive&#8221; promise:</p>

<p><img src="http://adamcaudill.com/files/2012-01-23_1716.png" alt="" /></p>

<p>I was hoping to run into the firewall (for lack of a better term) - looks like I got my wish; though since I wasn&#8217;t using anything automated and was just poking around by hand, it didn&#8217;t have any impact. Not terribly exciting, but it did provide some insight into what they are doing.</p>

<p>So far we&#8217;ve found a few interesting things, and bumped into their firewall, but that all pales in comparison to the last entry in the <code>dwsync.xml</code> file:</p>

<pre><code>&lt;file name="local-site.zip"
 server="ftp.belincreative.com/public_html/clients/mykonos/site/"
 local="129695851046591796"
 remote="129695888400000000"/&gt;
</code></pre>

<p>When I saw the file name I was shocked - could it really be? But I was right. It&#8217;s a 59MB file containing everything on the site - all the PHP and everything else. Out of curiosity, I compared the <code>.htaccess</code> to that in the zip file, as expected it&#8217;s quite different and more believable:</p>

<pre><code>Options +FollowSymlinks
RewriteEngine on
rewritecond %{http_host} ^mykonossoftware.com [nc]
rewriterule ^(.*)$ http://www.mykonossoftware.com/$1 [r=301,nc]
</code></pre>

<p>That confirms what I suspected, the file I saw earlier was just part of the trap.</p>

<p><strong>So what have we learned?</strong></p>

<p>1). Mykonos makes a really cool product, and had I not known what I was up against (and thus less skeptical about everything) it probably would have killed a lot of my time - just as intended.</p>

<p>2). No matter what you put in front or your site or application,<em> human mistakes are still your greatest risk</em>. A second set of eyes and a little paranoia go a long way in securing your systems, and stopping hackers.</p>

<p>3). Mykonos was either lucky or smart in that there was little on their site that shouldn&#8217;t be seen by the public. If they were using a CMS with a database back-end instead of simple (mostly-)static pages, this could have been worse. If they had source code or other valuable IP on the server, a mistake like this could be devastating.</p>

<p>4). Mykonos should take some of their new-found cash and hire somebody to finish the audit of their site that I started. ;)</p>

<p><em>Note:</em> I notified Mykonos about that zip file before posting this (through a couple of channels), and I&#8217;m intentionally not linking to it. While I didn&#8217;t see anything in there that would be an issue to be publicly disclosed, I&#8217;m sure they don&#8217;t want it getting out. Hopefully by the time anybody reads this, they will have taken care of that file.</p>

<p><em><strong>Update:</strong></em> As expect, they&#8217;ve cleaned up the files I mentioned - and a bit more. In a <a href="http://twitter.com/#!/dkoretz/status/162033710202486786">tweet</a> from the company&#8217;s CEO, <a href="http://www.davidkoretz.com/">David Koretz</a>, he mentioned that they had left a surprise for me. So I went to my starting point (the <code>/Templates/</code> directory), and was greeted with this:</p>

<p><img src="http://adamcaudill.com/files/2012-01-25_0005.png" alt="Welcome &amp; Thanks" /></p>

<p>Yeah, cool product and cool people. I&#8217;m impressed.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/13/">&larr; Older</a>
    
    <a href="/archives/">Blog Archives</a>
    
    <a class="next" href="/page/11/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=250" class="aligncenter"></p>
  <p>I am an independant security researcher and software developer with more than 15 years of experience. I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p>
  <p>Email: <a href="mailto:adam@adamcaudill.com">adam@adamcaudill.com</a> (<a href="https://adamcaudill.com/pgp/">PGP</a>)</p>
</section>
<section>
  <h1>Links</h1>
	<ul>
		<li><a href="https://twitter.com/adamcaudill">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/adamcaudill">LinkedIn</a></li>
		<li><a href="https://github.com/adamcaudill">GitHub</a></li>
		<li><a href="http://www.flickr.com/people/adamcaudill/">Flickr</a></li>
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/02/17/the-evolution-of-paranoia/">The Evolution of Paranoia</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/12/religion-free-speech-freedom-from-offense/">Religion, Free Speech & Freedom from Offense</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/03/utopia-found-utopia-lost/">Utopia Found; Utopia Lost</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/01/2014-a-year-in-review/">2014: Year In Review</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/20/irrational-attribution-apt3-dot-14159/">Irrational Attribution: APT3.14159</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adamcaudill">@adamcaudill</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adamcaudill',
            count: 4,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Enjoy this site? Consider donating via Bitcoin to <strong>14jumFDmuVkLiAt4TgyKt17SWHtPRbkcLr</strong>.<br>
  Copyright &copy; 2015 - Adam Caudill -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
