
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adam Caudill</title>
  <meta name="author" content="Adam Caudill">

  
  <meta name="description" content="Yesterday James B. Comey, the Director of the FBI continued the propaganda campaign against encryption with a fresh batch of lies and misdirection. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://adamcaudill.com//page/2">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Caudill" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link rel="openid.server" href="https://adamcaudill.com/MyID.config.php">
<link rel="openid.delegate" href="https://adamcaudill.com/MyID.config.php">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-106942-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Caudill</a></h1>
  
    <h2>Independent Security Researcher &amp; Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamcaudill.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/10/17/a-backdoor-by-any-other-name/">A Backdoor by Any Other Name&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-17T17:14:00-04:00" pubdate data-updated="true">Oct 17<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday James B. Comey, the Director of the FBI continued the propaganda campaign against encryption with a fresh batch of lies and misdirection. The FBI has been pushing to add backdoors to cryptosystems around the world - no matter how many people they put at risk in the process. Starting in the 1990’s, the FBI has been at the forefront of trying to make their job easier by endangering the world.</p>

<p>What Comey did today was to lay the foundation for a renewed push for a new, expansive, <a href="https://en.wikipedia.org/wiki/Communications_Assistance_for_Law_Enforcement_Act">CALEA</a> type law that would give <em>governments</em> access - via court orders or surreptitiously, to all of your data. In 2013 they were pushing for <a href="https://freedom-to-tinker.com/blog/felten/calea-ii-risks-of-wiretap-modifications-to-endpoints/">CALEA 2</a>, which would have expanded their ability to secretly access your data in a massive way. Thankfully the Snowden documents put an end to that - at least for awhile.</p>

<p>I use the term governments instead of specifying the US Government very intentionally. Under CALEA, certain systems must be compliant to be sold in the US - so companies add support, and then ship them all over the world instead of supporting two versions. So the FBI’s desire to have easy access to anything they want puts people around the world at risk. But surely nobody would abuse this, right?</p>

<p>In 2004, thanks to support for this type of “lawful intercept” support, <a href="https://en.wikipedia.org/wiki/Greek_wiretapping_case_2004%E2%80%9305">Vodaphone in Greece was hacked</a> - tapping top government and civil leaders. Who did it still isn’t known, but many suspect that the US Government was behind it. Then there’s <a href="https://firstlook.org/theintercept/2014/05/19/data-pirates-caribbean-nsa-recording-every-cell-phone-call-bahamas/">SOMALGET</a>, the NSA program to collect all calls made in the Bahamas. The DEA was given access to their phone systems for the purposes of “lawful intercept” - again, a CALEA compliant setup, which was then used to collect everything they were able to get. These are just two high profile examples, there are many cases where researchers have found flaws in these systems, making them easy prey.</p>

<p>For years, it’s been made clear that such backdoors were disasters - and it’s not just CALEA compliance either. There’s the infamous <a href="https://en.wikipedia.org/wiki/Clipper_chip">Clipper chip</a> which would encrypt voice calls, but allow the government to easily listen in - but thanks to fatal flaws, anyone else could as well.</p>

<p>Thanks to this, pretty much everybody agrees that backdoors are a bad idea, so the FBI had a great idea - call it something else!</p>

<h3>A rose by any other name…</h3>

<p>Comey, deciding that he shouldn’t have to deal with reality, and that the best way to address the public was misdirection:</p>

<blockquote><p>We aren’t seeking a back-door approach. We want to use the front door, with clarity and transparency, and with clear guidance provided by law.</p></blockquote>


<p>And by “front door”, he means some new backdoor into everything.</p>

<p>He wants the ability to decrypt data, without having to get information from the suspect; which means adding a backdoor to systems, to allow them - and likely many others to get in. This is no different than the disastrous Clipper chip idea.</p>

<p>The FBI is trying to misdirect the public, lead them to believe in some magical, secure backdoor that is abuse-proof. But when such an idea is being pushed by an organization that has so much abuse and illegal activity in its history - should anyone trust what they say?</p>

<h3>Putting enforcement first</h3>

<p>At one point Comey said something that I found shocking:</p>

<blockquote><p>Are we so mistrustful of government—and of law enforcement—that we are willing to let bad guys walk away&#8230;</p></blockquote>


<p>If you read the US Constitution, this is answered for him - in many places it is made clear, it’s better to let a criminal walk free than to infringe on the rights of the innocent. Preserving the rights of the people trumps everything.</p>

<p>For law enforcement, this isn’t about justice, or the rule of law - this is about their power, their ability to get what they want, when they want it. If they put people in harms way in the process, that’s a price they are willing to let the public pay.</p>

<h3>Only one government?</h3>

<p>In the discussions about this, one major point keeps being missed - this isn’t just about the US Government, but about the governments all around the world. If companies are forced to add backdoors to products for the US market, you can bet that same backdoor will be shipped to every country they work in.</p>

<p>So the danger is global - but as this is something that can be used for intelligence, as CALEA has been used for in the past, I’m sure this fact hasn’t escaped the attention of planners at the NSA. For the NSA, a CALEA 2 style law would give them easy access to expend their already vast - and illegal - collection operations. It would be a dream come true.</p>

<p>There’s also another international component to this issue - many major tech companies operate in several countries, making them subject to local courts. What happens when they receive a court order for access to this backdoor and a gag order, to prevent them from talking about it? Suddenly American data will be at risk from foreign powers.</p>

<p>There are so many issues opened up when backdoors are added, that one could talk for days and still not cover all the ways it could be abused.</p>

<h3>Lies and mistrust</h3>

<blockquote><p>Perhaps it’s time to suggest that the post-Snowden pendulum has swung too far in one direction—in a direction of fear and mistrust.</p></blockquote>


<p>It seems that Comey is surprised that people don’t trust the government, after lies, deception, and violations of law are revealed. How shocking.</p>

<p>The US Government has failed to uphold the Constitution, and technology companies have stepped up to provide a level of protection in the face of a Government that has ignored its obligations. I’m sure that the FBI would love to go back the old days - where we assume the government is doing the right thing while secretly violating the Constitution and ignoring international law. Anything to give them more power and control.</p>

<h3>The New Crypto Wars</h3>

<p>In the 1990s, the first crypto war was fought, and many believed that the public had won. What we are seeing is, without question, that a new war has started. Apple’s decision to change the way they encrypt phones wasn’t what started it - the writing had been on the walls for some time, it was just the ammunition they were waiting to go on the attack.</p>

<p>Those that work with cryptography daily fighting to protect users, while the government is busy trying to protect what they want, over the rights and protection of the people. Expect it to get ugly.</p>

<p>It’s going to be a fight, and what happens in the next year or two will be critical. If the FBI wins, privacy dies.</p>

<p><em>(Sorry for the ranty nature of this post - it’s an issue I feel strongly about, and something that we must take action on.)</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/10/03/on-the-ethics-of-badusb/">On the Ethics of BadUSB</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-03T12:28:00-04:00" pubdate data-updated="true">Oct 3<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last Friday, <a href="http://www.brandonw.net/">Brandon Wilson</a> and I gave a talk on BadUSB at DerbyCon - I wrote some <a href="https://adamcaudill.com/2014/10/02/making-badusb-work-for-you-derbycon/">about it yesterday</a>. Yesterday, Wired <a href="http://www.wired.com/2014/10/code-published-for-unfixable-usb-attack/">published</a> an article on the talk, kicking off several others - only the authors of the Wired and <a href="http://threatpost.com/badusb-attack-code-publicly-disclosed">Threatpost</a> articles contacted us for input.</p>

<p>There has been some questions raised as to the responsibility of releasing the code - so I want to take a few minutes to talk about what we released, why, and what the risks actually are.</p>

<h2>What we released.</h2>

<p>We released a two patches to the existing (v1.03.53) firmware for the Phison 2251-03, and a minimal custom firmware for that same chip.</p>

<p><strong>The Patches</strong></p>

<p>First, let me briefly describe the patches:</p>

<ul>
<li>Hidden Partition - A patch to create a second hidden partition, to show that data can be hidden, and not easily accessed unless you know the trick.</li>
<li>Password Bypass - A patch to modify the password protection mechanism to force the password to fixed value; so that any password will be accepted. Must be applied before the password is set by the user.</li>
</ul>


<p>The second patch does defeat a “security” mechanism on the device, though given that the patch must be applied before the password is set - it’s not a huge risk to users. We intentionally focused on changing behavior instead of adding composite devices, to show that the is more complex than what was displayed at the Black Hat talk.</p>

<p>So we’ve bypassed one security feature, and added a new feature.</p>

<p>The patches were carefully selected to make the point, while not endangering users.</p>

<p><strong>The Custom Firmware</strong></p>

<p>The custom firmware acts a HID device, typing out a pre-programmed payload when inserted to a computer. This is anything but new - this can be done with a <a href="https://hakshop.myshopify.com/products/usb-rubber-ducky-deluxe">USB Rubber Ducky</a>, a <a href="https://www.pjrc.com/teensy/">Teensy</a>, or a number of other devices.</p>

<p>This was released to prove the point that the device could be reprogrammed to be something completely different. If this is a new threat to anyone - they are very out of the loop.</p>

<p><strong>The Tools</strong></p>

<p>We also released a few tools that we developed to apply patches and to make our lives easier during the effort. Most of what they do is available in other tools from Phison or the device manufactures; we built the tools we needed, so we didn’t have to use third-party tools or deal with the limitations of those tools.</p>

<h2>What we DIDN’T release</h2>

<p>Now that we’ve talked about what was released, let’s talk about what it isn’t.</p>

<p><strong>Self replication</strong> - There’s no self replication code anywhere, while it’s possible that it could be done, and we’ve talked about how to do it - it won’t be released.</p>

<p>I am confident that we (Brandon and I) could build a system that would infect PCs, then infect a significant percentage of thumb drives, and then infect other PCs - but, and this is a <em>big</em> but - what we released doesn’t make that easier in any significant way.</p>

<p>Your average script kiddy will never be able to do it; there’s only a small number of people that would be able to do the work needed to be able to pull it off - those people could already do it before we released what we did.</p>

<p>The threat of this happening is the same as it has always been.</p>

<p><strong>Malware</strong> - There’s nothing malicious about what we’ve released here. While we did release a patch to modify the password protection feature - that’s all it does. It doesn’t modify data, infect computers with anything, or anything of that nature.</p>

<p>It changes the way a feature works. That’s it. This is a change that anyone with the required skills could have made - by making it public, we are raising awareness that users shouldn’t blindly trust.</p>

<p><strong>The end of USB as we know it</strong> - Nothing, nothing, that we’ve released has suddenly made new attacks possible. The USB specification allows composite devices to do unexpected things. USB devices (thumb drives or otherwise) that allow anyone to update the firmware without any checks, means that anything can potentially be reprogrammed to change functionality or become malicious.</p>

<p>All of these things have been true long before we released the first line of code. Anyone that believes otherwise doesn’t understand the technology.</p>

<p><strong>An unfixable issue that will end the world</strong> - While there isn’t quick fix for this, things can be improved quite a bit. We released simple code, that proves the issue, draws attention to the fact that users need to be more careful, while being careful to not cause more harm than good in the process.</p>

<p>This isn’t earth shattering. Anyone that thinks that it is, should probably give up and go live in a cave.</p>

<h2>The Risks</h2>

<p>What are the real risks here - what does this expose users to that it didn’t in the past?</p>

<p>Writing code for these devices is far from easy, especially when trying to patch the existing firmware. It’s not something that just anyone can jump into - while we have made it easier for people to apply simple patches and provided some insight to the process, these aren’t the patches that will lead to a firmware based worm or something of that nature - these are the type of patches that will make small changes to existing features, or add simple new features. Even then, it’s time consuming and difficult work.</p>

<p>So, to do anything still requires a lot of knowledge and skill - in general, as I said earlier, the kind of people that have what it takes to do this, could do it regardless of our release.</p>

<p>If a person (or group) was so inclined to take one of these devices and make it truly malicious - it’s unlikely that our research would have an impact.</p>

<p>I firmly believe that by releasing this code, the risk to the average user isn’t increased at all over what it already was.</p>

<h2>Why release?</h2>

<p>Device manufactures were quick to dismiss the “BadUSB” threat - on one hand, what was presented at Black Hat was possible via other means, so wasn’t really a new threat - but they showed no indication of trying to address the issues under their control.</p>

<p>For years devices have been sold with updatable firmware, but with no security checks at all - we had two goals with the release of the code:</p>

<ul>
<li>User awareness - As long as users implicitly trust devices, attacks will be possible and successful.</li>
<li>Push device manufactures to implement signed updates.</li>
</ul>


<p>While it will take years for any changes made by device manufactures to have an impact because of the number of devices in circulation now - if they keep ignoring the issue, then it will never be improved.</p>

<p>In doing this, we haven’t broken the security of these devices, but made it clear that it isn’t existent. If anyone is upset that we’ve removed the obscurity that had “protected” these devices - then to them I’m sorry that they understand so little that they believe that it’s real protection.</p>

<p>Part of the reason we released the “hidden partition” patch was to show that this can be used to add new features, that can add value in certain cases.</p>

<h2>The Full Disclosure debate</h2>

<p>When we started on this, we were concerned that this was being touted as a new threat, yet for defenders there was no way they could even test it, much less develop defense techniques.</p>

<p>So not only do we have something that defenders can’t test, we have something that the device manufactures are downplaying or ignoring. This is the setup for the classic full disclosure debate.</p>

<p>The first question that we asked ourselves, before we wrote the first line of code, is what is best for users? To allow the status quo to continue, or to expand the research into new directions and publish - to help make users aware and provide defenders something to work with.</p>

<p>The answer we came up with, is that we could develop patches that would clearly communicate the issue, without causing undue harm to end users.</p>

<p>In the end, looking at what we intended to release, what could be done that wouldn’t have been possible before that (which is fairly minimal), and the potential benefit - we felt, and still do, that full disclosure was appropriate.</p>

<p>In everything we’ve done, the priority has been protecting users - any media report that indicates otherwise is ill-informed, and providing bad information to the public.</p>

<h2>Breaking out of the echo chamber</h2>

<p>Given that the issue was so well known, the amount of attention - positive and negative - that this has received has really surprised us. It’s too common that when something like this is released it stays within the infosec echo chamber - this has broken out far more than I expected.</p>

<p>Most of the negative feedback has been from people and organizations that are well outside of the echo chamber - reminding me of just how ignorant the public can be when it comes to technical issues.</p>

<p>There are times that I wonder why we work so hard to protect these people.</p>

<h2>Has this been blown out of proportion?</h2>

<p>Yes.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/10/02/making-badusb-work-for-you-derbycon/">Making BadUSB Work for You - DerbyCon</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-02T22:15:00-04:00" pubdate data-updated="true">Oct 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last week <a href="http://www.brandonw.net/">Brandon Wilson</a> and I were honored to speak at <a href="https://www.derbycon.com/">DerbyCon</a>, on the work we’ve been doing on the Phison controller found in many USB thumb drives. This was my first time speaking at DerbyCon - it’s a great event, with a fantastic team making the magic happen.</p>

<p>Slides:</p>

<iframe src="//www.slideshare.net/slideshow/embed_code/39583508" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>


<p>Video (which I’ve haven’t been able to bring myself to watch):</p>

<iframe width="854" height="510" src="//www.youtube.com/embed/xcsxeJz3blI" frameborder="0" allowfullscreen></iframe>


<p>Now that the dust has settled, I would like to provide some updates, thoughts, and extra information - and <em>maybe</em> correct an error I made during the presentation.</p>

<h3>The Demos</h3>

<p>We did three demos - they were simple enough that I didn’t think there was any risk of having issues. Well, lesson learned.</p>

<p>The machine we used was a fresh Windows install just for the talk - though in the rush, there were a couple differences between it and the machine we had been testing with. In the panic of trying to get the talk done in the short 25-minute slot, I mistook these differences for a failing of one of the demos.</p>

<p><strong>Custom HID Firmware</strong></p>

<p>The first of the three demos was a completely custom firmware, that presents itself as a HID device (and as a mass storage device, though without media present - this is to make firmware updates easier) - the demo went without a hitch.</p>

<p>I would have liked to show the tools and the update process, though there just wasn’t time. Brandon is working on videos that will be posted to YouTube that walks through each demo step by step.</p>

<p>The team behind the <a href="https://hakshop.myshopify.com/products/usb-rubber-ducky-deluxe">Rubber Ducky</a> saved us a lot of time, thanks to the tools they had built - as we were able to support the same encoded format they used.</p>

<p><strong>Hidden Partition</strong></p>

<p>The hidden partition is a great patch, as there’s no way to tell that it’s there - everything works as expected, no reason to suspect that anything has been altered.</p>

<p>It divides the NAND space into two partitions, and the firmware lies about the size, to indicate that only half of the space is there. The “public” section is the first that’s mounted, and only a specific action will cause the second, hidden partition to become visible.</p>

<p>It’s a simple change, but it sends a clear message that there can be more than meets the eye with these devices. From a forensics perspective, the only way to ensure that what you are getting is accurate and complete, is to dump the NAND directly - without allowing the controller to access it.</p>

<p><strong>Password Protection Bypass</strong></p>

<p>This demo <em>seemed</em> to go wrong, but it actually performed perfectly - I was just in too much of a rush to think though what was happening, and why I didn’t see what I expected.</p>

<p>When I plugged the device in, I was expecting to see two drives from it - one “public”, the other unmounted. I only saw one. Two things went wrong here:</p>

<ul>
<li>“Show Empty Drives In Explorer” - By default Windows doesn’t show unmounted removable drives in “My Computer”; this is a setting I always change, and expected to see the unmounted drive. As this was a fresh install, the default setting was still set - the drive was there, I just couldn’t see it. This threw me off.</li>
<li>Wrong Password - During the demo I typed in some random junk to the password field of the “Lock” tool, and instead of it unlocking the drive as expected, it gave me the wrong password dialog. The issue here is a bug in the Phison code, when supplying a password more than 16 characters long it treats it as a bad password. So it was working, but the password I supplied was too long, triggering that bug.</li>
</ul>


<p>We later tested that drive again, and sure enough - it worked flawlessly, as long as the random password wasn’t longer than 16 characters.</p>

<p>The patch works by altering the buffer that stores the data once received over USB; it forces it to 16 “A”s, so that any password will work. Because of how it works, the patch must be applied before the user sets their password - otherwise it’ll just make the data inaccessible.</p>

<p>That was painful.</p>

<h3>The (maybe) error…</h3>

<p>During the talk I referred to modes 7 and 8 as being encrypted - this is <em>probably</em> wrong, at least on the devices we demoed. The two modes are password protected, and according to some documentation are encrypted, and according to other documentation they aren’t.</p>

<p>The question came up in a conversation after the talk - we’ve not had the time to dig into this feature more since then, but it’s looking like it’s just a password check with no encryption.</p>

<p>The password changing patch was added at the last minute, to replace another demo that we didn’t like - we identified the USB command being sent, and patched it. Due to time constraints we didn’t dig into the feature to verify the document (from a device manufacturer) was correct; after the question was raised we dug into a little more and looked for other documentation and code to support the claim - it looks like the document we were referencing was incorrect.</p>

<p>So, it looks like I misspoke - the patch still works as expected, though the feature itself seems to provide less protection than we initially though. Sorry!</p>

<h3>The Code &amp; Docs</h3>

<p>We have everything on the <a href="https://github.com/adamcaudill/Psychson">repo</a> now, and we’ve added some additional documentation to the <a href="https://github.com/adamcaudill/Psychson/wiki">wiki</a>.</p>

<p>This isn’t simple to do - the code is complicated to write, and the effort to use the patches and custom firmware is a bit more than I’d like. We’ve tried to document things as well as we can, hopefully it’s easy enough to understand.</p>

<h3>Next Steps</h3>

<p>We really hope that releasing this will push device manufactures to insist on signed firmware updates, and that Phison will add support for signed updates to all of the controllers it sells.</p>

<p>Phison isn’t the only player here, though they are the most common - I’d love to see them take the lead in improving security for these devices. They have an opportunity to stand up and protect users - as the most common provider of these controllers, I’d truly love to see them take this as an opportunity to lead the industry.</p>

<p>What we’ve released just scratches the surface of what can be done here - until signed updates are enforced, there’s no telling what games these devices could be playing.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/25/ietf-action-on-secure-email/">IETF Action on Secure Email</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-25T11:02:00-04:00" pubdate data-updated="true">Aug 25<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Early last week I emailed a group of IETF Area Directors, for the Security and Applications areas, asking them to start the process of creating a new Working Group to address the issues around email security. (Thanks Adrian Farrel for the prodding!)</p>

<p>Today, the first result of the effort has been completed - the new <a href="https://www.ietf.org/mailman/listinfo/endymail">endymail</a> mailing list. An IETF venue to discuss how these issues can be addressed, hopefully laying the ground work updated standards to improve email as we know it today, and eventually standardizing a replacement to SMTP and related protocols. Here&#8217;s the description that the group came up with for the new list:</p>

<blockquote><p>There is significant interest in improving the<br/>privacy-related properties of Internet mail. One focus of<br/>current efforts is on the per-hop (connection-based)<br/>protections provided by TLS. However a wide range of other<br/>work has a focus on end-to-end protection, at the Internet<br/>scale of billions of end users and perhaps millions of<br/>operators.  Such work typically involves new forms of mail<br/>header or body protection, new public key management<br/>(compared to S/MIME or PGP), and security mechanisms more<br/>appropriate for mobile/web user-agents.  Other<br/>security-relevant approaches may be discussed if needed.<br/>Various proposals and development efforts on this topic are<br/>underway outside the IETF. This mailing list provides an<br/>IETF venue for discussion of elements that might be commonly<br/>needed by such efforts and to identify work that the IETF<br/>could do to aid in achieving better end-to-end security<br/>deployed for Internet email.</p></blockquote>


<p>While the creation of another mailing list is far from ground breaking, it&#8217;s the necessary first step in standardizing a solution to a decades old problem.</p>

<p>I encourage everyone interested in email security and privacy to join the list, and participate in the discussions that will lead to new standards. (Though please wait a bit for people to subscribe before starting discussions.)</p>

<p>A big thanks to Stephen Farrell, Joe Hildebrand, and Pete Resnick for their enthusiastic support for this effort.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/16/smimp-at-the-defcon-cryptovillage/">SMIMP at the DEFCON Crypto Village</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-16T00:00:00-04:00" pubdate data-updated="true">Aug 16<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last week I gave a lighting talk at the DEFCON CryptoVillage on <a href="http://smimp.org/">SMIMP</a>. The talk went over the basics of why the project is needed, and how the specification works.</p>

<p>Here are the slides:</p>

<iframe src="//www.slideshare.net/slideshow/embed_code/38040741?rel=0&startSlide=2" width="512" height="421" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>


<p>Here is a rough transcript of the talk:</p>

<p><em>Slide 1:</em> I&#8217;m Adam Caudill, I’m a developer and security researcher; I work on a number of different things, but my recent work has been around privacy and secure messaging.</p>

<p>We all know that email security is a real problem, and thanks to a certain whistleblower we know those weaknesses are actively being exploited on a massive scale. I&#8217;m here to talk about some of the issues, and a project I&#8217;ve been working on called SMIMP. It&#8217;s a secure messaging protocol that aims to address the use cases of email, and to be a viable option to replace email as we know it.</p>

<p><em>Slide 2:</em> This image illustrates the issues with email better than anything I&#8217;ve seen.</p>

<p>It&#8217;s decades old, wasn&#8217;t designed for the threats that exist today, and as a result - this is what we&#8217;ve done to it. We&#8217;ve glued on various bits to make it look and feel like something it isn&#8217;t. STARTTLS helps protect from passive monitoring, but that&#8217;s only one attack vector out of so many - and even then, it&#8217;s often opportunistic, so it fails open and is subject to Man In The Middle attacks.</p>

<p>GPG helps protect message content, but it&#8217;s hard for the average user to understand and doesn&#8217;t do anything for metadata.</p>

<p>No matter what we try to glue on to email, it&#8217;s still a protocol that fails on many fronts.</p>

<p><em>Slide 3:</em> Not only is email as it exists today not designed to provide any protection from state-level attackers, it doesn&#8217;t even provide any protection from a rogue sysadmin. Thanks to the various bits that have been glued on over the years, it&#8217;s a bit better when circumstances are ideal - but it still fails on so many fronts.</p>

<p>For a messaging protocol to have any chance of being secure, privacy and security need to be evaluated and included in every design decision, from the very first day - attempting to glue them on after the fact leads to the kind of failure we&#8217;ve seen with email.</p>

<p>I know I&#8217;m preaching to the choir here. We all know it&#8217;s a mess, we all know it&#8217;s a problem that needs to be addressed.</p>

<p><em>Slide 4:</em> There are many people looking to make the situation better, and on many fronts, and these efforts  do help a little bit at a time - but often only for people that know how to leverage the tools, or can get others to implement solutions. For the vast majority of users, the current state of email security is pretty dismal.</p>

<p>The question is, does it make sense, in the long term, to keep trying to find ways to improve email with security focused clients (such as Mailpile), better self-hosting setups, fighting companies to implement STARTTLS, and so on. Or, should we be pushing for a new protocol that&#8217;s built for security and privacy from the ground up? Avoiding the mistakes of the past, shedding the dead weight of obsolete protocols and techniques.</p>

<p>There are huge compatibility and interoperability issues that have to be addressed for any protocol to be successful of course - when you are trying to replace a system used by billions, dealing with legacy systems is something of a big deal.</p>

<p>The fact is, it <em>needs</em> to be replaced with something better, but even calling such an effort a massive undertaking is an understatement. But, if it is to be replaced, it needs to start with groups like this, so that what&#8217;s built will live up to the demands that will be placed on it.</p>

<p><em>Slide 5:</em> Towards the goal of finding a better option for email, I began writing a specification. If I&#8217;m going to complain about a problem I should offer a solution, right?</p>

<p>SMIMP is a general purpose messaging system designed with a few key goals in mind:</p>

<ul>
<li>Minimal metadata</li>
<li>Encrypt as much as possible</li>
<li>Covers existing email use cases</li>
<li>Simple to use; normal users need to be able to use it</li>
<li>Useable in corporate environments that have special handling requirements - such as HIPAA, SarbOx, etc. - This is a big advantage against options like bitmessage; there has to be a balance between security, and meeting the varying demands of the different environments this could be used in.</li>
</ul>


<p>Another goal is ease of implementation - on both the client and server ends; so it&#8217;s a REST-like web service, and the data is passed as JSON. This way developers can leverage well-tested code instead of writing everything from scratch. This also means that it&#8217;s easy for people to host their own server with a minimal time / effort investment.</p>

<p><em>Slide 6:</em> SMIMP is made up of two major components, identity management and messaging. I believe it&#8217;s critical that these are combined into a single protocol to allow for key pain points in traditional email to be addressed - the largest being public key discovery. For GPG, this can be a real challenge for users, especially when trying to find the key for certain high-profile people; has anyone looked for Jacob Applebaum&#8217;s key? It&#8217;s Bad.</p>

<p>Every user has one public signing key in their profile information - the key is tied to the user&#8217;s address, so to find a user&#8217;s key, all you need is their address. This provides a clean, simple way to identify the appropriate key for a user. Of course, ideally users should verify public signing keys via a trusted channel such as a phone call.</p>

<p>To protect the integrity of the profile information, all changes are signed with the user&#8217;s signing key, and includes the hash of the prior change - creating a hash chain from the first, to the most recent change, allowing for simple validation that the records haven&#8217;t been altered.</p>

<p>To protect against a malicious server, there are a couple checks that clients can perform:</p>

<ul>
<li>Pin the most recent signing key, if it disappears from the user&#8217;s profile, then the information is being truncated, possibly to force the use of a compromised key.</li>
<li>Pin the original signing key from when the account was created; if that ever changes, that is a clear indication that the entire history for a user has been replaced.</li>
</ul>


<p>On the messaging side, all messages and most metadata is encrypted; the only data exposed is the data needed for the server to function. There are multiple message types, so not only does it support email like messages, it supports custom, application specific messages; this allows other message-centric applications to use SMIMP as a transport, making it easier to build secure messaging applications.</p>

<p>There are a few anti-spam protections in place - seeing as the server won&#8217;t be able to scan content anymore.</p>

<ul>
<li>Dynamic hashcash-like proof of work</li>
<li>Blacklists to reject everything from an address or domain</li>
<li>Whitelists to allow addresses or domains to bypass the proof of work check.</li>
</ul>


<p>The envelope is JSON, for email, the message is JSON, the formats are extensible, making it easy to add new functionality.</p>

<p>Everything is designed around a simple set of principles:</p>

<ul>
<li>Secure</li>
<li>Private</li>
<li>Easy to implement</li>
<li>Hard to screw-up</li>
</ul>


<p><em>Slide 7:</em> So, what&#8217;s the status today&#8230;</p>

<p>The specification is still a work in progress and is available from smimp.org, along with more background of what it is, and why it&#8217;s designed the way it is.</p>

<p>I wouldn&#8217;t try building against it just yet, it&#8217;s still too immature, but if anybody wants to put their 2 cents in, the specification is on github and pull requests are welcome. The goal here is to get feedback, address issues, and try to build a community driven specification - my goal isn&#8217;t to write a specification myself and then push it on the world assuming it&#8217;s perfect.</p>

<p>I&#8217;ve invested a fair bit of time into SMIMP, but it&#8217;s certainly not perfect, and the final solution to the email problem may not be anything like SMIMP - and I&#8217;m fine with that.</p>

<p>What&#8217;s needed is more people looking not at how to we glue more things on email, but looking at how could we replace it. We need to get more people talking about possible solutions, for more people to contribute to specifications, or write new ones, to get more people focused on the one goal that will actually fix email security - replacing it.</p>

<p><em>Slide 8:</em> I encourage you to look at the specification, to think about how replacing email could be achieved, and find people to work with to achieve this.</p>

<p>If you have any questions, suggestions, or complaints - I&#8217;ll be in the area for a bit.</p>

<p>Thanks!</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/3/">&larr; Older</a>
    
    <a href="/archives/">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=250" class="aligncenter"></p>
  <p>I am an independant security researcher and software developer with more than 15 years of experience. I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p>
  <p>Email: <a href="mailto:adam@adamcaudill.com">adam@adamcaudill.com</a> (<a href="https://adamcaudill.com/pgp/">PGP</a>)</p>
</section>
<section>
  <h1>Links</h1>
	<ul>
		<li><a href="https://twitter.com/adamcaudill">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/adamcaudill">LinkedIn</a></li>
		<li><a href="https://github.com/adamcaudill">GitHub</a></li>
		<li><a href="http://www.flickr.com/people/adamcaudill/">Flickr</a></li>
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/01/01/2014-a-year-in-review/">2014: Year In Review</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/20/irrational-attribution-apt3-dot-14159/">Irrational Attribution: APT3.14159</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/03/orwellian-justice/">Orwellian Justice</a>
      </li>
    
      <li class="post">
        <a href="/2014/11/23/speaking-at-sc-magazine-congress/">Speaking at SC Magazine Congress</a>
      </li>
    
      <li class="post">
        <a href="/2014/10/19/on-nsa-proof-security/">On NSA-Proof Security</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adamcaudill">@adamcaudill</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adamcaudill',
            count: 4,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Enjoy this site? Consider donating via Bitcoin to <strong>14jumFDmuVkLiAt4TgyKt17SWHtPRbkcLr</strong>.<br>
  Copyright &copy; 2015 - Adam Caudill -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
