
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Adam Caudill</title>
  <meta name="author" content="Adam Caudill">

  
  <meta name="description" content="Update 2: The Snapchat API has changed to address the issues I pointed out to them - and the new API has issues as well. I&#8217;ve posted an update &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://adamcaudill.com//page/9">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Adam Caudill" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link rel="openid.server" href="https://adamcaudill.com/MyID.config.php">
<link rel="openid.delegate" href="https://adamcaudill.com/MyID.config.php">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-106942-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Adam Caudill</a></h1>
  
    <h2>Independent Security Researcher &amp; Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adamcaudill.com/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/06/16/snapchat-api-and-security/">Snapchat: API &amp; Security</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-16T21:06:00-04:00" pubdate data-updated="true">Jun 16<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Update 2:</strong> The Snapchat API has changed to address the issues I pointed out to them - and the new API has issues as well. I&#8217;ve <a href="http://adamcaudill.com/2012/12/31/revisiting-snapchat-api-and-security/">posted an update</a> that covers some of these changes.</p>

<p><strong>Update:</strong> I heard back from one of the co-founders, he said that they&#8217;d be updating the application to address this in the &#8220;very near future.&#8221; I have to applaud them for the great way they handled this.</p>

<p><a href="http://www.snapchat.me/">Snapchat</a> was recently <a href="http://techcrunch.com/2012/06/08/snapchat-110-million/">featured</a> on TechCrunch, pointing out that they are expanding to Android and that they&#8217;ve now handled over 110M pictures. So when I see something about an application that auto-deletes messages after they are viewed - I did the only natural thing: dig in and see if it really is secure.</p>

<p>I <a href="http://adamcaudill.com/2012/06/10/monitor-iphone-http-s-traffic-with-fiddler/">monitored</a> the messages being sent back and forth, and mapped out the APIs they use. They have a simple API, which uses both JSON and form-encoding to transfer data. The API itself is fairly clean and easy to understand. Writing a new client against this API is fairly simple - <em>including a client that automatically saves all image received</em>.</p>

<h3>Downloading Images</h3>

<p>The process to download images is pretty simple, it can be as simple as two API calls. The first API needed is <code>ss_auth</code> - the API is used to create sessions. The call to login looks like this:</p>

<pre><code>POST https://feelinsonice.appspot.com/ss_auth HTTP/1.1
Host: feelinsonice.appspot.com
User-Agent: Snapchat 3.0 rv:3.0.0 (iPhone; iPhone OS 5.1.1; en_US)
Content-Length: 32
Content-Type: application/x-www-form-urlencoded; charset=utf-8
Accept-Encoding: gzip
Connection: close
Proxy-Connection: close

u=&lt;user&gt;&amp;t=&lt;password&gt;&amp;a=login
</code></pre>

<p>This will return JSON containing couple useful things:</p>

<ol>
<li>The session token, which is required for all other calls.</li>
<li>A list of images that haven&#8217;t been viewed yet (the &#8220;id&#8221; field being the most important).</li>
</ol>


<p>Once the returned JSON is parsed, the rest is just making calls to the <code>blob</code> API - this is the API that actually returns the image data (as a JPG), and can then be saved to disk. The URLs to retrieve an image look like this:</p>

<pre><code>https://feelinsonice.appspot.com/blob?u=&lt;user&gt;&amp;t=&lt;session-token&gt;&amp;i=&lt;image-id&gt;
</code></pre>

<p>This allows images to be easily downloaded, without them being removed.</p>

<h3>How it normally works&#8230;</h3>

<p>In the mobile application, a call to the <code>ss_pa</code> API is made when an image is viewed, this removes the image - and once this is called, there doesn&#8217;t seem to be a way to get the image back.</p>

<pre><code>POST https://feelinsonice.appspot.com/ss_pa HTTP/1.1
Host: feelinsonice.appspot.com
User-Agent: Snapchat 3.0 rv:3.0.0 (iPhone; iPhone OS 5.1.1; en_US)
Content-Length: 102
Content-Type: application/x-www-form-urlencoded; charset=utf-8
Accept-Encoding: gzip
Connection: close
Proxy-Connection: close

u=&lt;user&gt;&amp;t=&lt;session-token&gt;&amp;v_str=%7B%22&lt;image-id&gt;%22%3A%22&lt;unix-timestamp&gt;%22%7D
</code></pre>

<p>This API call is the key to keeping the image from being accessed again. If a client didn&#8217;t implement this API, it would allow users to access the images any time they like - completely bypassing the entire point of the application.</p>

<h3>Other APIs</h3>

<p>Here are some of the other APIs used:</p>

<ul>
<li><code>ss_refresh</code> - pull the list of images (this API returns a subset of what&#8217;s returned by <code>ss_auth</code>)</li>
<li><code>nsp</code> - uploads an image</li>
<li><code>clear</code> - clears the user&#8217;s history</li>
<li><code>auth</code> - used to destroy the session, not to be confused with <code>ss_auth</code></li>
</ul>


<p>All of these are easily understood and implemented. There are other APIs, for things like registration that I didn&#8217;t look into, as they are beyond the scope of this research.</p>

<h3>Unofficial clients</h3>

<p>With such a simple API I&#8217;d be amazed if other, unofficial, clients didn&#8217;t start turning up - with saving images being their primary feature. A crappy but functional Android client that supports saving could be built in a couple hours.</p>

<p>For now I&#8217;m not making any proof-of-concept code available, as I believe that this article makes it sufficiently clear how easy it is to write an unofficial client for this service that allows images to be saved. The goal here isn&#8217;t to exploit this hole, but to point out the risk of untrusted clients.</p>

<h3>Overall</h3>

<p>Session management is fairly well done - and would certainly make unofficial clients that aren&#8217;t full-featured less attractive due to needing to login so often; but this certainly doesn&#8217;t provide any protection. The API itself seems to have no protection against untrusted clients, making it trivial to save images or perform other unintended actions.</p>

<p>I did contact the authors to suggest that they encrypt the image data when it&#8217;s sent to the client, making it harder to get the data without reverse engineering the application. It wouldn&#8217;t stop everyone, but it would make the task less trivial.</p>

<p>Given the nature of the application, I suspect unofficial clients are unavoidable though - especially as the service grows in popularity (as I expect it will once the official Android client is released).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/06/10/monitor-iphone-http-s-traffic-with-fiddler/">Monitor iPhone HTTP(S) Traffic With Fiddler</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-10T14:10:00-04:00" pubdate data-updated="true">Jun 10<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For a research project I decided that I needed to monitor the traffic to and from my iPhone - both HTTP and HTTPS. Having had so much luck with Fiddler in the past, it was the first place I looked. There are a number of posts on this topic, but few that provide a clear and complete picture of what&#8217;s needed. So I wrote one.</p>

<p>First, install the latest version of <a href="http://www.fiddler2.com/fiddler2/version.asp">Fiddler</a>, then install the iOS-compatible <a href="http://www.fiddler2.com/dl/FiddlerCertMaker.exe">certificate generator</a>. Now update the settings to decrypt HTTPS traffic:</p>

<p><img class="center" src="http://adamcaudill.com/files/2012-06-10_1430.png"></p>

<p>Next, update the settings to allow remote connections (make sure that restart Fiddler after this):</p>

<p><img class="center" src="http://adamcaudill.com/files/2012-06-10_1433.png"></p>

<p>Then export the Fiddler Root Certificate to your desktop from the options dialog:</p>

<p><img class="center" src="http://adamcaudill.com/files/2012-06-10_1436.png"></p>

<p>Email the <code>FiddlerRoot.cer</code> file to your iPhone - you&#8217;ll need to import and trust the certificate to make this work. To install certificate, just click on the attachment and click the &#8216;Install&#8217; button.</p>

<p>Now configure your iPhone to use the Fiddler proxy. The setting can be found at Setting -> Wi-Fi -> (your network) -> HTTP Proxy -> Manual. Set the &#8216;Server&#8217; to the IP address of of your PC, then set &#8216;Port&#8217; to 8888, and &#8216;Authentication&#8217; to off.</p>

<p>You should now be able to see all of the HTTP and HTTPS traffic going across your phone. It&#8217;s worth noting though, that some applications won&#8217;t work while using the proxy - Twitter being one, though most work without issue.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/06/06/linkedin-a-little-common-sense/">LinkedIn: A Little Common Sense</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-06T18:28:00-04:00" pubdate data-updated="true">Jun 6<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The fact that LinkedIn was breached has been well covered and <a href="http://blog.linkedin.com/2012/06/06/linkedin-member-passwords-compromised/">confirmed</a>, but in their confirmation they said something that I personally found insulting, more than anything else:</p>

<blockquote><p>It is worth noting that the affected members who update their passwords and members whose passwords have not been compromised benefit from the enhanced security we just recently put in place, which includes hashing and salting of our current password databases.</p></blockquote>


<p>So, they just recently started salting their hashes? Seriously?</p>

<p>Storing passwords via unsalted SHA-1 is not only unsafe, it&#8217;s reckless. When you store user credentials, you have a responsibility to your users to keep their data safe - in this case LinkedIn failed, epicly. Had they bothered to think about security, or hired people that understood even the most basic principles of secure application development - this wouldn&#8217;t have happened.</p>

<p>When properly implemented, hashed data shouldn&#8217;t be (practically) reversible to its original value - that is, after all, the purpose of hashing. Tweets like this though, make it painfully clear just how wrong LinkedIn got it:</p>

<div class='embed tweet'><blockquote class="twitter-tweet" align="center"><p>So far 3,427,202 passwords have cracked from LinkedIn List Almost 50%Its been about 24 hours - The longest? a 29 letter sentence from Bible</p>&mdash; KoreLogic(@CrackMeIfYouCan) <a href="https://twitter.com/CrackMeIfYouCan/status/210474428407103490">June 6, 2012</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>


<p>They violated the most basic security principles, but more importantly, they violated their users&#8217; trust.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/05/20/piracy-is-not-theft/">Piracy Is Not Theft</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-20T18:31:00-04:00" pubdate data-updated="true">May 20<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For many years now groups like the MPAA and RIAA have tried to convince the public that piracy (that is, copyright infringement) is theft - and many people have come to believe this, but it&#8217;s not true. In reality, copyright infringement is far more analogous to trespassing than it is to theft in its core concepts - and even moreso in the digital world.</p>

<p>To make it clear, I am looking at this from a largely historical perspective, looking at the origins of copyright and how it was intended to be used. This gives us a better view than the current laws that have been greatly influenced and complicated by politics and money from those that have a vested interest in maximizing copyright protections and broadening its definitions.</p>

<p>First, let&#8217;s look at the legal definition of theft - this specific definition is from British law, from which many early American laws derived.</p>

<blockquote><p>A person is guilty of theft, if he dishonestly appropriates property belonging to another with the intention of permanently depriving the other of it&#8230;</p></blockquote>


<p>Next, let&#8217;s take a look at this excerpt from the <a href="http://en.wikipedia.org/wiki/Copyright_Act_of_1790">Copyright Act of 1790</a>, the first copyright act at the federal level in the United States - which was heavily influenced by the 1710 <a href="http://en.wikipedia.org/wiki/Statute_of_Anne">Statute of Anne</a>:</p>

<blockquote><p>&#8230;the author and authors of any map, chart, book or books already printed within these United States, &#8230;, who halt or have not transferred to any other person the copyright of such map, chart, book or books, share or shares thereof; and any other person or persons, &#8230;, shall have the sole right and liberty of printing, reprinting, publishing and vending such map, chart, book or books, for the term of fourteen years from the recording the title thereof in the clerk’s office&#8230;</p></blockquote>


<p>Copyright, in its origin and intended forms provides something very simple: the right to control how a work (primarily a book) is copied. That&#8217;s it, that simple.</p>

<p>So from a historical perspective, a copyright violation was to create a copy of book without the authors permission - theft would have been to take a book that the author printed, permanently depriving him of that asset. These are clearly not the same thing - despite the assertions of certain powerful groups.</p>

<p>I&#8217;m not defending or down playing piracy, but let&#8217;s talk about it in the proper context - it&#8217;s a property rights issue, not theft.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/05/19/slipping-past-lastpass/">Slipping Past LastPass</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-19T13:54:00-04:00" pubdate data-updated="true">May 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Update:</strong> LastPass has confirmed that they&#8217;ll address this issue in the next release.</p>

<p><strong>Update 2:</strong> LastPass has addressed this issue in their new v2.0 release. There is still a way to bypass the password prompt in Chrome, but they will address that in the next release. Overall, it looks like we can close the books on this one.</p>

<p>I&#8217;m a big fan of <a href="https://lastpass.com/">LastPass</a> - it&#8217;s a great service that has impressed me every step of the way. Though it&#8217;s not perfect, and I&#8217;ve found a small hole that makes it easier for an attacker to get your passwords - if the following are true:</p>

<ol>
<li>The attacker has physical access to your PC.</li>
<li>You&#8217;ve made the mistake of not locking your PC when you walk away.</li>
<li>You&#8217;ve select the option to stay logged on - which happens to be a default, or, you&#8217;ve left your browser open (as I expect most people do).</li>
</ol>


<p><img class="center" src="http://adamcaudill.com/files/lastpass_default_opt.png"></p>

<p>If all three of these are true (or your PC is otherwise compromised) - you probably shouldn&#8217;t expect much in the way of security, but LastPass does protect you - most of the time. If you try to copy or view a password, you&#8217;ll be prompted to enter your Master Password - but there&#8217;s one case that can easily expose your passwords without needing to know the Master Password.</p>

<p>The issue is that LastPass allows you to change the address associated with a login without confirming your master password. This would allow an attacker to update an entry in your vault to a specially crafted page to echo the password - allowing the attacker to see the password and leave minimal tracks behind. I setup a <a href="http://adamcaudill.com/files/EchoLoginForm.html">special page</a> to test this, it echoes the password as soon as LastPass enters it, allowing me to see the password in a few seconds without providing the master password (it&#8217;s also possible to update the password without providing the Master Password, providing another opportunity for mischief).</p>

<p><img class="center" src="http://adamcaudill.com/files/lastpass_edit.png"></p>

<p><strong>Automation</strong></p>

<p>While I&#8217;ve not taken the time to build a tool to automate this - it would be a fairly simple process to do, just a matter of investing the time (which unfortunately I don&#8217;t have). The obvious solution would be to automate the GUI interaction to perform the following steps:</p>

<ul>
<li>Change the URL to a malicious page.</li>
<li>Navigate to the page, and log the login data.</li>
<li>Revert the URL to the original value.</li>
</ul>


<p>Using this method it would be possible to collect all of a users credentials within just a few minutes. It&#8217;s possible there may be a simpler &amp; faster route available by interacting directly with the plug-ins, though in looking at the exports and COM interfaces I didn&#8217;t see an obvious way to achieve this (which as a LastPass user, this makes me happy).</p>

<p>For an attacker, one substantial upside is that there would be little evidence of the event - while the LastPass Vault will show that all entries have been &#8220;touched&#8221; recently, I would venture to say that very few users would actually notice.</p>

<p>While this attack requires full access as the logged-in user, if a PC is otherwise compromised (perhaps as part of an APT type attack), it could allow an attacker to greatly expand their activities with a minimal time investment. This is the type of situation that could take a fairly small local information disclosure and turn it into a real nightmare scenario for a targeted user.</p>

<p><strong>Solution</strong></p>

<p>The simplest solution for this issue is to require Master Password verification if the URL changes, or at least require it if the domain changes. This should be a minor change for them and will eliminate this attack vector. Thankfully this is a minor issue, due to the three requirements required to pull this off - so I don&#8217;t believe there is too much risk due to this oversight.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/10/">&larr; Older</a>
    
    <a href="/archives/">Blog Archives</a>
    
    <a class="next" href="/page/8/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=250" class="aligncenter"></p>
  <p>I am an independant security researcher and software developer with more than 15 years of experience. I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p>
  <p>Email: <a href="mailto:adam@adamcaudill.com">adam@adamcaudill.com</a> (<a href="https://adamcaudill.com/pgp/">PGP</a>)</p>
</section>
<section>
  <h1>Links</h1>
	<ul>
		<li><a href="https://twitter.com/adamcaudill">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/adamcaudill">LinkedIn</a></li>
		<li><a href="https://github.com/adamcaudill">GitHub</a></li>
		<li><a href="http://www.flickr.com/people/adamcaudill/">Flickr</a></li>
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/01/01/2014-a-year-in-review/">2014: Year In Review</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/20/irrational-attribution-apt3-dot-14159/">Irrational Attribution: APT3.14159</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/03/orwellian-justice/">Orwellian Justice</a>
      </li>
    
      <li class="post">
        <a href="/2014/11/23/speaking-at-sc-magazine-congress/">Speaking at SC Magazine Congress</a>
      </li>
    
      <li class="post">
        <a href="/2014/10/19/on-nsa-proof-security/">On NSA-Proof Security</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adamcaudill">@adamcaudill</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adamcaudill',
            count: 4,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Enjoy this site? Consider donating via Bitcoin to <strong>14jumFDmuVkLiAt4TgyKt17SWHtPRbkcLr</strong>.<br>
  Copyright &copy; 2015 - Adam Caudill -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
